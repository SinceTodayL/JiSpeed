import{d as w,aG as k,aH as x,L as i,af as z,b as n,o as a,f as B,e as o,aq as r,aI as C,t as p,c as _,w as g,g as h,B as V,aJ as N,as as L}from"./index-ljSV_Uvg.js";import{_ as S}from"./wave-bg.vue_vue_type_script_setup_true_lang-DXKCydQ-.js";const b={class:"verify-email-container"},I={class:"verify-content"},M={class:"verify-icon"},q={key:0,width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},E={key:1,width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},R={key:2,width:"80",height:"80",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},T={class:"verify-text"},D={key:0},G={class:"verify-button"},H=w({name:"verify-email",__name:"index",setup(J){const d=k(),y=x(),u=i(!1),e=i("pending"),s=i(""),v=i(""),c=i("");z(()=>{v.value=d.query.userId||"",c.value=d.query.token||"",(!v.value||!c.value)&&(e.value="error",s.value="验证链接无效，缺少必要参数")});async function f(){if(!v.value||!c.value){s.value="验证参数不完整，请重新点击邮件中的验证链接";return}try{u.value=!0,e.value="pending";const{data:l,error:t}=await N(v.value,c.value);if(!l){e.value="error",s.value="验证失败，请重试 (backend error, fetchVerifyEmail() return None)";return}l.code===0?(e.value="success",s.value="邮箱验证成功！正在跳转到登录页面...",setTimeout(()=>{y.push("/login")},50)):(e.value="error",s.value=l?.message||"验证失败，请重试")}catch(l){e.value="error",s.value="网络错误，请稍后重试",console.error("Verification error:",l)}finally{u.value=!1}}return(l,t)=>{const m=V;return a(),n("div",b,[B(S,{"theme-color":"#1890ff"}),o("div",I,[o("div",M,[e.value==="pending"?(a(),n("svg",q,t[0]||(t[0]=[o("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z",fill:"#1890ff"},null,-1)]))):r("",!0),e.value==="success"?(a(),n("svg",E,t[1]||(t[1]=[o("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z",fill:"#52c41a"},null,-1)]))):r("",!0),e.value==="error"?(a(),n("svg",R,t[2]||(t[2]=[o("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z",fill:"#ff4d4f"},null,-1)]))):r("",!0)]),o("div",T,[t[3]||(t[3]=o("h2",null,"邮箱验证",-1)),e.value==="pending"?(a(),n("p",D," 请点击下方按钮完成邮箱验证，验证成功后即可正常使用济时达外卖服务。 ")):r("",!0),s.value?(a(),n("p",{key:1,class:C({"success-text":e.value==="success","error-text":e.value==="error"})},p(s.value),3)):r("",!0)]),o("div",G,[e.value==="pending"?(a(),_(m,{key:0,type:"primary",size:"large",loading:u.value,onClick:f},{default:g(()=>[h(p(u.value?"验证中...":"验证邮箱"),1)]),_:1},8,["loading"])):r("",!0),e.value==="error"?(a(),_(m,{key:1,type:"primary",size:"large",onClick:f},{default:g(()=>t[4]||(t[4]=[h(" 重新验证 ")])),_:1,__:[4]})):r("",!0)])])])}}}),A=L(H,[["__scopeId","data-v-e6d0bdc1"]]);export{A as default};
