import{d as R,m as A,Z as M,r as b,n as S,c as x,a0 as q,a as z,o as w,e as r,b as l,w as s,g as d,a1 as c,M as $,p as O,q as P,h as V,I as F,B as T,f as v,a5 as E,t as G,a7 as Z,bG as H,a8 as J}from"./index-C9iIelhG.js";import{_ as K}from"./Form-C6cUAX00.js";const L={class:"h-full p-24px bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800"},Q={class:"flex items-center gap-3"},W={class:"w-12 h-12 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl flex items-center justify-center"},X={class:"flex items-center justify-between"},Y={class:"flex items-center gap-3"},ee={class:"w-8 h-8 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-lg flex items-center justify-center"},ae={class:"space-y-20px"},oe={class:"flex gap-24px"},re={class:"flex-1"},le={class:"flex-1"},se={class:"flex gap-24px"},te={class:"flex-1"},ne={class:"mt-24px flex justify-center border-t border-gray-200 pt-16px dark:border-gray-700"},ie={class:"flex gap-3"},de=R({name:"profile",__name:"index",setup(ce){const k=A(),U=M(),N=b(null);b(!1);const m=b(!1),a=S({applicationUserId:"",name:"",phoneNumber:"",riderId:"",vehicleNumber:""}),o=b({applicationUserId:"",name:"",phoneNumber:"",riderId:"",vehicleNumber:""}),f=x(()=>k.userInfo.userId||U.riderId||""),_=x(()=>{const{name:i,phoneNumber:e,vehicleNumber:u}=a;return!!(i&&e&&u)}),I=x(()=>a.name!==o.value.name||a.phoneNumber!==o.value.phoneNumber||a.vehicleNumber!==o.value.vehicleNumber),C={name:[{required:!0,message:"è¯·è¾“å…¥å§“å",trigger:"blur"},{max:50,message:"å§“åé•¿åº¦ä¸èƒ½è¶…è¿‡50ä¸ªå­—ç¬¦",trigger:"blur"}],phoneNumber:[{required:!0,message:"è¯·è¾“å…¥æ‰‹æœºå·",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"è¯·è¾“å…¥æ­£ç¡®çš„æ‰‹æœºå·æ ¼å¼",trigger:"blur"}],vehicleNumber:[{required:!0,message:"è¯·è¾“å…¥è½¦è¾†ç¼–å·",trigger:"blur"},{max:20,message:"è½¦è¾†ç¼–å·é•¿åº¦ä¸èƒ½è¶…è¿‡20ä¸ªå­—ç¬¦",trigger:"blur"}]};async function y(){try{console.log("ğŸ”„ å¼€å§‹è·å–éª‘æ‰‹ä¿¡æ¯..."),console.log("ğŸ†” éª‘æ‰‹IDï¼š",f.value);const i=await Z(f.value);console.log("ğŸ“¥ è·å–éª‘æ‰‹ä¿¡æ¯APIå“åº”ï¼š",i);const{data:e}=i;console.log("ğŸ“¥ è·å–åˆ°çš„æ•°æ®ï¼š",e),e?(Object.assign(a,e),o.value.applicationUserId=e.applicationUserId||"",o.value.name=e.name||"",o.value.phoneNumber=e.phoneNumber||"",o.value.riderId=e.riderId||"",o.value.vehicleNumber=e.vehicleNumber||"",console.log("âœ… è·å–éª‘æ‰‹ä¿¡æ¯æˆåŠŸï¼"),console.log("ğŸ“ æ›´æ–°åçš„formModelï¼š",a),console.log("ğŸ“ æ›´æ–°åçš„originalDataï¼š",o.value)):console.warn("âš ï¸ è·å–åˆ°çš„æ•°æ®ä¸ºç©º")}catch(i){console.error("è·å–éª‘æ‰‹ä¿¡æ¯å¤±è´¥",i),window.$message?.error("è·å–éª‘æ‰‹ä¿¡æ¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥");const e={applicationUserId:"mock_user_001",name:"æµ‹è¯•éª‘æ‰‹",phoneNumber:"13800138000",riderId:f.value,vehicleNumber:"å®A12345"};Object.assign(a,e),o.value.applicationUserId=e.applicationUserId,o.value.name=e.name,o.value.phoneNumber=e.phoneNumber,o.value.riderId=e.riderId,o.value.vehicleNumber=e.vehicleNumber}}q(()=>{y()});async function j(){N.value?.validate(async i=>{if(i)return;m.value=!0;const{name:e,phoneNumber:u,vehicleNumber:g}=a;try{console.log("ğŸš€ å¼€å§‹ä¿å­˜éª‘æ‰‹ä¿¡æ¯..."),console.log("ğŸ†” éª‘æ‰‹IDï¼š",a.riderId),console.log("ğŸ“¤ å‘é€çš„æ•°æ®ï¼š",{riderId:a.riderId,name:e,phoneNumber:u,vehicleNumber:g}),console.log("ğŸŒ è°ƒç”¨updateRiderInfo API...");const n=await H(a.riderId,{name:e,phoneNumber:u,vehicleNumber:g});console.log("ğŸ“¥ å®Œæ•´APIå“åº”ï¼š",n),console.log("ğŸ“¥ å“åº”ç±»å‹ï¼š",typeof n),console.log("ğŸ“¥ å“åº”ç»“æ„ï¼š",Object.keys(n));const{data:t}=n;console.log("ğŸ“¥ å“åº”æ•°æ®ï¼š",t),console.log("ğŸ“¥ æ•°æ®ç±»å‹ï¼š",typeof t),t?(window.$message?.success("ä¸ªäººä¿¡æ¯ä¿å­˜æˆåŠŸï¼"),Object.assign(a,t),o.value.applicationUserId=t.applicationUserId||"",o.value.name=t.name||"",o.value.phoneNumber=t.phoneNumber||"",o.value.riderId=t.riderId||"",o.value.vehicleNumber=t.vehicleNumber||"",console.log("âœ… ä¿å­˜æˆåŠŸï¼"),console.log("ğŸ“ æ›´æ–°åçš„formModelï¼š",a),console.log("ğŸ“ æ›´æ–°åçš„originalDataï¼š",o.value)):(console.warn("âš ï¸ APIè¿”å›æ•°æ®ä¸ºç©º"),window.$message?.warning("ä¿å­˜æˆåŠŸï¼Œä½†æœªè¿”å›æ›´æ–°åçš„æ•°æ®"))}catch(n){console.error("ä¿å­˜éª‘æ‰‹ä¿¡æ¯å¤±è´¥",n);const t=n?.response?.data?.message||"ä¿å­˜å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•";window.$message?.error(t)}finally{m.value=!1}})}const B=()=>{a.applicationUserId=o.value.applicationUserId,a.name=o.value.name,a.phoneNumber=o.value.phoneNumber,a.riderId=o.value.riderId,a.vehicleNumber=o.value.vehicleNumber};return(i,e)=>{const u=$,g=E,n=P,t=O,h=T,D=K;return w(),z("div",L,[r(u,{bordered:!1,class:"mb-24px bg-white/80 dark:bg-gray-800/80 backdrop-blur-sm"},{default:s(()=>[l("div",Q,[l("div",W,[r(d(c),{icon:"mdi:account-circle",class:"text-2xl text-white"})]),e[3]||(e[3]=l("div",null,[l("h1",{class:"text-2xl text-gray-800 font-bold dark:text-gray-200"},"ä¸ªäººä¿¡æ¯ç®¡ç†"),l("p",{class:"mt-2px text-gray-600 dark:text-gray-400"},"ç®¡ç†æ‚¨çš„ä¸ªäººåŸºæœ¬ä¿¡æ¯å’Œè´¦æˆ·è®¾ç½®ï¼Œç¡®ä¿ä¿¡æ¯å‡†ç¡®æ— è¯¯")],-1))])]),_:1}),l("div",null,[r(u,{bordered:!1,class:"rounded-16px shadow-lg bg-white/90 dark:bg-gray-800/90 backdrop-blur-sm"},{header:s(()=>[l("div",X,[l("div",Y,[l("div",ee,[r(d(c),{icon:"mdi:account-edit",class:"text-lg text-white"})]),e[4]||(e[4]=l("span",{class:"text-lg font-semibold text-gray-800 dark:text-gray-200"},"åŸºæœ¬ä¿¡æ¯",-1))]),r(g,{type:_.value?"success":"warning",size:"small",round:""},{icon:s(()=>[r(d(c),{icon:_.value?"mdi:check-circle":"mdi:alert-circle"},null,8,["icon"])]),default:s(()=>[v(" "+G(_.value?"å·²å®Œå–„":"å¾…å®Œå–„"),1)]),_:1},8,["type"])])]),default:s(()=>[r(D,{ref_key:"formRef",ref:N,model:a,rules:C,"label-placement":"top","label-width":"120px","require-mark-placement":"right-hanging",size:"large"},{default:s(()=>[l("div",ae,[l("div",oe,[l("div",re,[r(t,{label:"å§“å",path:"name"},{default:s(()=>[r(n,{value:a.name,"onUpdate:value":e[0]||(e[0]=p=>a.name=p),placeholder:"è¯·è¾“å…¥æ‚¨çš„çœŸå®å§“å",clearable:""},{prefix:s(()=>[r(d(c),{icon:"mdi:account",class:"text-gray-400"})]),_:1},8,["value"])]),_:1})]),l("div",le,[r(t,{label:"æ‰‹æœºå·",path:"phoneNumber"},{default:s(()=>[r(n,{value:a.phoneNumber,"onUpdate:value":e[1]||(e[1]=p=>a.phoneNumber=p),placeholder:"è¯·è¾“å…¥æ‰‹æœºå·ç ï¼ˆå¿…å¡«ï¼‰",clearable:""},{prefix:s(()=>[r(d(c),{icon:"mdi:phone",class:"text-gray-400"})]),_:1},8,["value"])]),_:1})])]),l("div",se,[l("div",te,[r(t,{label:"è½¦è¾†ç¼–å·",path:"vehicleNumber"},{default:s(()=>[r(n,{value:a.vehicleNumber,"onUpdate:value":e[2]||(e[2]=p=>a.vehicleNumber=p),placeholder:"è¯·è¾“å…¥è½¦è¾†ç¼–å·",clearable:""},{prefix:s(()=>[r(d(c),{icon:"mdi:car",class:"text-gray-400"})]),_:1},8,["value"])]),_:1})]),e[5]||(e[5]=l("div",{class:"flex-1"},null,-1))])]),l("div",ne,[l("div",ie,[r(h,{type:"default",size:"large",onClick:y,disabled:m.value},{icon:s(()=>[r(d(c),{icon:"mdi:refresh"})]),default:s(()=>[e[6]||(e[6]=v(" åˆ·æ–° "))]),_:1,__:[6]},8,["disabled"]),I.value?(w(),V(h,{key:0,type:"default",size:"large",onClick:B,disabled:m.value},{icon:s(()=>[r(d(c),{icon:"mdi:close"})]),default:s(()=>[e[7]||(e[7]=v(" å–æ¶ˆ "))]),_:1,__:[7]},8,["disabled"])):F("",!0),r(h,{type:"primary",size:"large",loading:m.value,disabled:!I.value,class:"bg-gradient-to-r from-blue-500 to-purple-600 border-0",onClick:j},{icon:s(()=>[r(d(c),{icon:"mdi:content-save"})]),default:s(()=>[e[8]||(e[8]=v(" ä¿å­˜æ›´æ”¹ "))]),_:1,__:[8]},8,["loading","disabled"])])])]),_:1},8,["model"])]),_:1})])])}}}),pe=J(de,[["__scopeId","data-v-740207ef"]]);export{pe as default};
