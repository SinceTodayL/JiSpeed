import{_ as V,N as E,a as x,h as I,b as C}from"./rider-error-handler-DqmGt7rc.js";import{d as $,r,a as j,O as L,b as P,o as O,f as l,e as s,w as n,h as a,M as u,t as o,B as w,g as c,c as Q,I as U,P as N,Q as q,R as T}from"./index-DSqQRdfM.js";import{_ as F}from"./Space-DnyABEot.js";const G={class:"h-full p-24px"},H={class:"flex items-center justify-between"},J={class:"flex items-center space-x-16px"},K={class:"text-center"},W={class:"text-2xl text-gray-800 font-bold dark:text-gray-200"},X={class:"text-center"},Y={class:"text-lg text-gray-800 font-semibold dark:text-gray-200"},Z={class:"text-center"},tt={class:"text-lg text-gray-800 font-semibold dark:text-gray-200"},et={class:"flex space-x-12px"},st={class:"grid grid-cols-4 mb-24px gap-16px"},at={class:"text-center"},lt={class:"text-2xl text-blue-600 font-bold"},nt={class:"text-center"},ot={class:"text-2xl text-green-600 font-bold"},dt={class:"text-center"},ct={class:"text-2xl text-yellow-600 font-bold"},it={class:"text-center"},rt={class:"text-2xl text-red-600 font-bold"},B="1663b73718a54c65b32f5b6787972949",ft=$({name:"attendance",__name:"index",setup(ut){const i=r([]),y=r(!1),h=r(!1),d=r(null),g={present:{text:"正常",type:"success"},absent:{text:"缺勤",type:"error"},late:{text:"迟到",type:"warning"},leave:{text:"请假",type:"info"}},k=r(null),v=r(!1),p=r(!1),D=async()=>{y.value=!0;try{i.value=[{id:"1",riderId:B,date:"2024-01-15",checkInTime:"08:30:00",checkOutTime:"18:00:00",status:"present",location:"北京市朝阳区",notes:"正常出勤"},{id:"2",riderId:B,date:"2024-01-14",checkInTime:"08:45:00",checkOutTime:"18:30:00",status:"late",location:"北京市朝阳区",notes:"迟到15分钟"}]}catch(t){I(t,"获取考勤记录")}finally{y.value=!1}},b=async()=>{try{const t=new Date().toISOString().split("T")[0],e=i.value.find(_=>_.date===t);e&&(k.value=e,v.value=!!e.checkInTime,p.value=!!e.checkOutTime)}catch(t){I(t,"获取今日考勤")}},M=async()=>{try{window.$message?.success("打卡成功！"),v.value=!0,await b()}catch(t){C(t,"打卡失败，请稍后重试")}},R=async()=>{try{window.$message?.success("签退成功！"),p.value=!0,await b()}catch(t){C(t,"签退失败，请稍后重试")}},S=t=>{d.value=t,h.value=!0},z=[{title:"日期",key:"date",render:t=>t.date},{title:"上班时间",key:"checkInTime",render:t=>t.checkInTime||"-"},{title:"下班时间",key:"checkOutTime",render:t=>t.checkOutTime||"-"},{title:"状态",key:"status",render:t=>{const e=g[t.status];return T(N,{type:e.type,size:"small"},{default:()=>e.text})}},{title:"位置",key:"location",render:t=>t.location||"-"},{title:"备注",key:"notes",render:t=>t.notes||"-"},{title:"操作",key:"actions",render:t=>T(F,{},{default:()=>[T(w,{size:"small",type:"primary",onClick:()=>S(t)},{default:()=>"详情"})]})}],m=j(()=>{const t=i.value.length,e=i.value.filter(f=>f.status==="present").length,_=i.value.filter(f=>f.status==="late").length,A=i.value.filter(f=>f.status==="absent").length;return{total:t,present:e,late:_,absent:A,attendanceRate:t>0?Math.round(e/t*100):0}});return L(()=>{D(),b()}),(t,e)=>(O(),P("div",G,[l(a(u),{bordered:!1,class:"mb-24px"},{default:n(()=>e[1]||(e[1]=[s("div",{class:"flex items-center justify-between"},[s("div",{class:"flex-1"},[s("h1",{class:"text-2xl text-gray-800 font-bold dark:text-gray-200"},"考勤管理"),s("p",{class:"mt-8px text-gray-600 dark:text-gray-400"},"记录和管理您的出勤情况，保持工作纪律。")])],-1)])),_:1,__:[1]}),l(a(u),{title:"今日考勤",class:"mb-24px"},{default:n(()=>[s("div",H,[s("div",J,[s("div",K,[s("div",W,o(new Date().toLocaleDateString("zh-CN")),1),e[2]||(e[2]=s("div",{class:"text-sm text-gray-500"},"今日日期",-1))]),s("div",X,[s("div",Y,o(k.value?.checkInTime||"未打卡"),1),e[3]||(e[3]=s("div",{class:"text-sm text-gray-500"},"上班时间",-1))]),s("div",Z,[s("div",tt,o(k.value?.checkOutTime||"未签退"),1),e[4]||(e[4]=s("div",{class:"text-sm text-gray-500"},"下班时间",-1))])]),s("div",et,[l(a(w),{type:"primary",disabled:v.value,onClick:M},{default:n(()=>[c(o(v.value?"已打卡":"打卡"),1)]),_:1},8,["disabled"]),l(a(w),{type:"info",disabled:!v.value||p.value,onClick:R},{default:n(()=>[c(o(p.value?"已签退":"签退"),1)]),_:1},8,["disabled"])])])]),_:1}),s("div",st,[l(a(u),null,{default:n(()=>[s("div",at,[s("div",lt,o(m.value.total),1),e[5]||(e[5]=s("div",{class:"text-sm text-gray-500"},"总出勤天数",-1))])]),_:1}),l(a(u),null,{default:n(()=>[s("div",nt,[s("div",ot,o(m.value.present),1),e[6]||(e[6]=s("div",{class:"text-sm text-gray-500"},"正常出勤",-1))])]),_:1}),l(a(u),null,{default:n(()=>[s("div",dt,[s("div",ct,o(m.value.late),1),e[7]||(e[7]=s("div",{class:"text-sm text-gray-500"},"迟到次数",-1))])]),_:1}),l(a(u),null,{default:n(()=>[s("div",it,[s("div",rt,o(m.value.attendanceRate)+"%",1),e[8]||(e[8]=s("div",{class:"text-sm text-gray-500"},"出勤率",-1))])]),_:1})]),l(a(u),{title:"考勤记录",bordered:!1,class:"rounded-16px shadow-sm"},{default:n(()=>[l(a(V),{columns:z,data:i.value,loading:y.value,pagination:{pageSize:10},class:"mt-16px"},null,8,["data","loading"])]),_:1}),l(a(q),{show:h.value,"onUpdate:show":e[0]||(e[0]=_=>h.value=_),preset:"card",title:"考勤详情",style:{width:"600px"}},{default:n(()=>[d.value?(O(),Q(a(E),{key:0,column:2,bordered:""},{default:n(()=>[l(a(x),{label:"日期"},{default:n(()=>[c(o(d.value.date),1)]),_:1}),l(a(x),{label:"状态"},{default:n(()=>[l(a(N),{type:g[d.value.status].type},{default:n(()=>[c(o(g[d.value.status].text),1)]),_:1},8,["type"])]),_:1}),l(a(x),{label:"上班时间"},{default:n(()=>[c(o(d.value.checkInTime||"-"),1)]),_:1}),l(a(x),{label:"下班时间"},{default:n(()=>[c(o(d.value.checkOutTime||"-"),1)]),_:1}),l(a(x),{label:"位置"},{default:n(()=>[c(o(d.value.location||"-"),1)]),_:1}),l(a(x),{label:"备注"},{default:n(()=>[c(o(d.value.notes||"-"),1)]),_:1})]),_:1})):U("",!0)]),_:1},8,["show"])]))}});export{ft as default};
