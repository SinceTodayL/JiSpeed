import{d as j,m as z,c as B,r as v,n as C,a4 as S,a as $,o as R,e as s,w as a,b as t,M as q,p as M,q as O,g as u,a5 as c,B as V,f as h,a7 as A,t as I,a9 as F,bx as G,ac as L}from"./index-7XOA-Oji.js";import{a as T,_ as E}from"./Grid-DGSovTqe.js";import{_ as H}from"./Form-WsZgJH-1.js";import{_ as J}from"./Space-BWHwIwlk.js";const K={class:"h-full p-24px"},P={class:"flex items-center"},Q={class:"space-y-20px"},W={class:"flex gap-24px"},X={class:"flex-1"},Y={class:"flex-1"},Z={class:"flex gap-24px"},ee={class:"flex-1"},se={class:"flex-1"},te={class:"flex gap-24px"},ae={class:"flex-1"},ne={class:"mt-24px flex justify-center border-t border-gray-200 pt-16px dark:border-gray-700"},oe={class:"flex items-center"},le={class:"flex items-center justify-between"},re={class:"flex items-center justify-between"},ie={class:"text-sm"},de={class:"flex items-center justify-between"},ue={class:"text-sm"},ce=j({name:"profile",__name:"index",setup(pe){const d=z(),_=B(()=>d.userInfo.userId),g=v(null),m=v(!1),n=C({applicationUserId:"",name:"",phoneNumber:"",riderId:"",vehicleNumber:""}),y={name:[{required:!0,message:"请输入姓名",trigger:"blur"},{max:50,message:"姓名长度不能超过50个字符",trigger:"blur"}],phoneNumber:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号格式",trigger:"blur"}],vehicleNumber:[{max:20,message:"车辆编号长度不能超过20个字符",trigger:"blur"}]};async function N(){try{const{data:r}=await F({riderId:_.value});r&&Object.assign(n,r)}catch(r){console.error("获取骑手信息失败",r),window.$message?.error("获取骑手信息失败，请检查网络连接"),Object.assign(n,{applicationUserId:_.value||`rider_${Date.now()}`,name:"测试骑手",phoneNumber:"13800138000",riderId:_.value,vehicleNumber:"宁A12345"})}}S(async()=>{!d.userInfo.userId&&d.token&&await d.initUserInfo(),d.userInfo.userId||Object.assign(d.userInfo,{userId:`rider_${Date.now()}`,userName:"测试骑手",roles:["rider"],buttons:[]}),N()});async function w(){g.value?.validate(async r=>{if(r)return;m.value=!0;const{name:e,phoneNumber:p,vehicleNumber:i}=n;try{const{data:o}=await G(n.riderId,{name:e,phoneNumber:p,vehicleNumber:i});o&&(window.$message?.success("个人信息更新成功！"),Object.assign(n,o))}catch(o){console.error("更新骑手信息失败",o);const f=o?.response?.data?.message||"更新失败，请稍后重试";window.$message?.error(f)}finally{m.value=!1}})}return(r,e)=>{const p=q,i=O,o=M,f=V,k=H,x=T,D=A,b=J,U=E;return R(),$("div",K,[s(p,{bordered:!1,class:"mb-24px"},{default:a(()=>e[5]||(e[5]=[t("div",{class:"flex items-center justify-between"},[t("div",{class:"flex-1"},[t("h1",{class:"text-2xl text-gray-800 font-bold dark:text-gray-200"},"个人信息管理"),t("p",{class:"mt-8px text-gray-600 dark:text-gray-400"},"管理您的个人基本信息和账户设置，确保信息准确无误。")])],-1)])),_:1,__:[5]}),s(U,{cols:24,"x-gap":16,"y-gap":16},{default:a(()=>[s(x,{span:16},{default:a(()=>[s(p,{bordered:!1,class:"rounded-16px shadow-sm"},{header:a(()=>[t("div",P,[s(u(c),{icon:"mdi:account-edit",class:"text-xl text-blue-500"}),e[6]||(e[6]=t("span",{class:"text-lg font-semibold"},"基本信息",-1))])]),default:a(()=>[s(k,{ref_key:"formRef",ref:g,model:n,rules:y,"label-placement":"top","label-width":"120px","require-mark-placement":"right-hanging",size:"large"},{default:a(()=>[t("div",Q,[t("div",W,[t("div",X,[s(o,{label:"用户ID",path:"applicationUserId"},{default:a(()=>[s(i,{value:n.applicationUserId,"onUpdate:value":e[0]||(e[0]=l=>n.applicationUserId=l),placeholder:"用户ID",disabled:"",class:"bg-gray-50 dark:bg-gray-800"},null,8,["value"])]),_:1})]),t("div",Y,[s(o,{label:"骑手ID",path:"riderId"},{default:a(()=>[s(i,{value:n.riderId,"onUpdate:value":e[1]||(e[1]=l=>n.riderId=l),placeholder:"骑手ID",disabled:"",class:"bg-gray-50 dark:bg-gray-800"},null,8,["value"])]),_:1})])]),t("div",Z,[t("div",ee,[s(o,{label:"姓名",path:"name"},{default:a(()=>[s(i,{value:n.name,"onUpdate:value":e[2]||(e[2]=l=>n.name=l),placeholder:"请输入您的真实姓名",clearable:""},{prefix:a(()=>[s(u(c),{icon:"mdi:account",class:"text-gray-400"})]),_:1},8,["value"])]),_:1})]),t("div",se,[s(o,{label:"手机号",path:"phoneNumber"},{default:a(()=>[s(i,{value:n.phoneNumber,"onUpdate:value":e[3]||(e[3]=l=>n.phoneNumber=l),placeholder:"请输入手机号码",clearable:""},{prefix:a(()=>[s(u(c),{icon:"mdi:phone",class:"text-gray-400"})]),_:1},8,["value"])]),_:1})])]),t("div",te,[t("div",ae,[s(o,{label:"车辆编号",path:"vehicleNumber"},{default:a(()=>[s(i,{value:n.vehicleNumber,"onUpdate:value":e[4]||(e[4]=l=>n.vehicleNumber=l),placeholder:"请输入车辆编号",clearable:""},{prefix:a(()=>[s(u(c),{icon:"mdi:car",class:"text-gray-400"})]),_:1},8,["value"])]),_:1})]),e[7]||(e[7]=t("div",{class:"flex-1"},null,-1))])]),t("div",ne,[s(f,{type:"primary",size:"large",loading:m.value,onClick:w},{icon:a(()=>[s(u(c),{icon:"mdi:content-save"})]),default:a(()=>[e[8]||(e[8]=h(" 保存更改 "))]),_:1,__:[8]},8,["loading"])])]),_:1},8,["model"])]),_:1})]),_:1}),s(x,{span:8},{default:a(()=>[s(b,{vertical:"",size:16},{default:a(()=>[s(p,{bordered:!1},{header:a(()=>[t("div",oe,[s(u(c),{icon:"mdi:account-check",class:"text-xl text-green-500"}),e[9]||(e[9]=t("span",{class:"text-lg font-semibold"},"账户状态",-1))])]),default:a(()=>[s(b,{vertical:"",size:12},{default:a(()=>[t("div",le,[e[11]||(e[11]=t("span",null,"账户状态",-1)),s(D,{type:"success",size:"small"},{default:a(()=>e[10]||(e[10]=[h("正常")])),_:1,__:[10]})]),t("div",re,[e[12]||(e[12]=t("span",null,"注册时间",-1)),t("span",ie,I(new Date().toLocaleDateString("zh-CN")),1)]),t("div",de,[e[13]||(e[13]=t("span",null,"最后更新",-1)),t("span",ue,I(new Date().toLocaleDateString("zh-CN")),1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})])}}}),xe=L(ce,[["__scopeId","data-v-7d59e301"]]);export{xe as default};
