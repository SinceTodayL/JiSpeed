import{O as H,P as Y,d as ie,Q as p,R as q,S as _e,U as ue,V as De,W as Ce,c as V,X as Ae,Y as L,m as Se,Z as Ie,a0 as ze,r as b,a1 as $e,a as j,o as C,e as n,w as r,b as a,g as s,a2 as R,t as u,M as z,I as $,B as Q,f as y,a3 as re,h as X,a4 as Te,a5 as T,a6 as Re,a7 as Ne,a8 as Le}from"./index-CMAb16hT.js";import{_ as Oe}from"./Spin-DOHlLna8.js";import{N as We,a as Pe,b as Z}from"./DescriptionsItem-Dzvc3U3y.js";import{_ as N,a as oe}from"./Grid-Dl48--Ul.js";import{_ as Be}from"./Space-BEGBHwHL.js";const Fe=H("statistic",[Y("label",`
 font-weight: var(--n-label-font-weight);
 transition: .3s color var(--n-bezier);
 font-size: var(--n-label-font-size);
 color: var(--n-label-text-color);
 `),H("statistic-value",`
 margin-top: 4px;
 font-weight: var(--n-value-font-weight);
 `,[Y("prefix",`
 margin: 0 4px 0 0;
 font-size: var(--n-value-font-size);
 transition: .3s color var(--n-bezier);
 color: var(--n-value-prefix-text-color);
 `,[H("icon",{verticalAlign:"-0.125em"})]),Y("content",`
 font-size: var(--n-value-font-size);
 transition: .3s color var(--n-bezier);
 color: var(--n-value-text-color);
 `),Y("suffix",`
 margin: 0 0 0 4px;
 font-size: var(--n-value-font-size);
 transition: .3s color var(--n-bezier);
 color: var(--n-value-suffix-text-color);
 `,[H("icon",{verticalAlign:"-0.125em"})])])]),Me=Object.assign(Object.assign({},ue.props),{tabularNums:Boolean,label:String,value:[String,Number]}),G=ie({name:"Statistic",props:Me,slots:Object,setup(c){const{mergedClsPrefixRef:o,inlineThemeDisabled:O,mergedRtlRef:W}=_e(c),x=ue("Statistic","-statistic",Fe,De,c,o),d=Ce("Statistic",W,o),f=V(()=>{const{self:{labelFontWeight:P,valueFontSize:m,valueFontWeight:B,valuePrefixTextColor:g,labelTextColor:k,valueSuffixTextColor:_,valueTextColor:F,labelFontSize:A},common:{cubicBezierEaseInOut:S}}=x.value;return{"--n-bezier":S,"--n-label-font-size":A,"--n-label-font-weight":P,"--n-label-text-color":k,"--n-value-font-weight":B,"--n-value-font-size":m,"--n-value-prefix-text-color":g,"--n-value-suffix-text-color":_,"--n-value-text-color":F}}),v=O?Ae("statistic",void 0,f,c):void 0;return{rtlEnabled:d,mergedClsPrefix:o,cssVars:O?void 0:f,themeClass:v?.themeClass,onRender:v?.onRender}},render(){var c;const{mergedClsPrefix:o,$slots:{default:O,label:W,prefix:x,suffix:d}}=this;return(c=this.onRender)===null||c===void 0||c.call(this),p("div",{class:[`${o}-statistic`,this.themeClass,this.rtlEnabled&&`${o}-statistic--rtl`],style:this.cssVars},q(W,f=>p("div",{class:`${o}-statistic__label`},this.label||f)),p("div",{class:`${o}-statistic-value`,style:{fontVariantNumeric:this.tabularNums?"tabular-nums":""}},q(x,f=>f&&p("span",{class:`${o}-statistic-value__prefix`},f)),this.value!==void 0?p("span",{class:`${o}-statistic-value__content`},this.value):q(O,f=>f&&p("span",{class:`${o}-statistic-value__content`},f)),q(d,f=>f&&p("span",{class:`${o}-statistic-value__suffix`},f))))}});function je(c){return L({url:`/api/Attendance/today/${c}`,method:"get"})}function Ve(c){return L({url:`/api/Attendance/${c}`,method:"get"})}function Ue(c,o={}){return L({url:`/api/Attendance/rider/${c}`,method:"get",params:o})}function Ee(c,o){return L({url:`/api/Attendance/rider/${c}/daterange`,method:"get",params:o})}function He(c,o={}){return L({url:`/api/Attendance/stats/rider/${c}`,method:"get",params:o})}function Ye(c){return L({url:`/api/Attendance/checkout/${c}`,method:"post"})}function qe(c){return L({url:`/api/Attendance/checkin/${c}`,method:"post"})}const Qe={class:"min-h-full bg-gradient-to-br from-blue-50 to-indigo-100 p-24px dark:from-gray-900 dark:to-gray-800"},Xe={class:"flex items-center gap-3"},Ze={class:"flex h-12 w-12 items-center justify-center rounded-xl bg-gradient-to-r from-blue-500 to-purple-600"},Ge={class:"text-2xl font-bold text-gray-800 dark:text-gray-200"},Je={class:"mt-2px text-gray-600 dark:text-gray-400"},Ke={class:"flex items-center justify-between"},et={class:"flex items-center space-x-32px"},tt={class:"text-center"},at={class:"text-4xl font-bold text-blue-600 dark:text-blue-400"},st={class:"mt-4px text-sm text-gray-500"},nt={class:"text-center"},lt={class:"text-lg font-semibold text-gray-800 dark:text-gray-200"},rt={class:"text-sm text-gray-500"},ot={class:"text-center"},it={class:"text-lg font-semibold text-gray-800 dark:text-gray-200"},ut={class:"text-sm text-gray-500"},ct={key:0,class:"text-sm text-gray-500"},dt={class:"flex space-x-16px"},gt={class:"stat-card-content"},vt={class:"stat-icon-wrapper"},ft={class:"stat-card-content"},pt={class:"stat-icon-wrapper"},mt={class:"stat-card-content"},ht={class:"stat-icon-wrapper"},xt={class:"stat-card-content"},bt={class:"stat-icon-wrapper"},wt={class:"flex h-full items-end"},yt={class:"flex items-center justify-between"},kt={key:0,class:"mt-1 flex flex-wrap gap-2"},_t={class:"text-sm text-gray-500"},Dt={key:0,class:"space-y-16px"},Ct={class:"grid grid-cols-2 gap-16px"},At={class:"rounded-lg bg-gray-50 p-16px text-center dark:bg-gray-800"},St={class:"text-lg font-semibold text-gray-800 dark:text-gray-200"},It={class:"rounded-lg bg-gray-50 p-16px text-center dark:bg-gray-800"},zt={class:"grid grid-cols-2 gap-16px"},$t={class:"rounded-lg bg-blue-50 p-16px text-center dark:bg-blue-900/20"},Tt={class:"text-lg font-semibold text-blue-800 dark:text-blue-200"},Rt={class:"rounded-lg bg-green-50 p-16px text-center dark:bg-green-900/20"},Nt={class:"text-lg font-semibold text-green-800 dark:text-green-200"},Lt={key:0,class:"rounded-lg bg-purple-50 p-16px text-center dark:bg-purple-900/20"},Ot={class:"text-lg font-semibold text-purple-800 dark:text-purple-200"},J=3,Wt=ie({name:"attendance",__name:"index",setup(c){const o=Se(),O=Ie(),{t:W}=ze(),x=V(()=>O.riderId||o.userInfo.userId),d=b([]),f=b(null),v=b(null),P=b(null),m=b(!1),B=b(!1),g=b(null),k=b(!1),_=b(!1),F=b(new Date),A=b(0),S=b(0),i=b({startDate:null,endDate:null,status:void 0}),h=b({page:1,pageSize:15,itemCount:0}),ce=()=>{F.value=new Date};async function de(){try{const{data:e}=await Ne(x.value);if(e){const t=e.data||e;f.value=t}}catch(e){console.error("获取骑手信息失败:",e),console.error("错误详情:",{message:e?.message,response:e?.response?.data,status:e?.response?.status}),f.value={riderId:x.value,name:"骑手",phoneNumber:"",vehicleNumber:"",applicationUserId:x.value}}}async function M(){try{const{data:e}=await je(x.value);if(e){const t=e.data||e;v.value=t,k.value=!!t.checkInAt,_.value=!!t.checkoutAt}else v.value=null,k.value=!1,_.value=!1}catch(e){console.error("获取今日考勤状态失败:",e),v.value=null,k.value=!1,_.value=!1}}async function w(){m.value=!0;try{const e={pageIndex:h.value.page,pageSize:h.value.pageSize};if(i.value.startDate&&i.value.startDate!==null){const l=new Date(i.value.startDate);e.startDate=l.toISOString().split("T")[0]}if(i.value.endDate&&i.value.endDate!==null){const l=new Date(i.value.endDate);e.endDate=l.toISOString().split("T")[0]}i.value.status==="late"?e.isLate=1:i.value.status==="absent"?e.isAbsent=1:i.value.status==="present"&&(e.isLate=0,e.isAbsent=0);let t;if(e.startDate&&e.endDate&&e.startDate.trim()!==""&&e.endDate.trim()!==""){const l={startDate:e.startDate,endDate:e.endDate,pageIndex:e.pageIndex,pageSize:e.pageSize,...e.isLate!==void 0&&{isLate:e.isLate},...e.isAbsent!==void 0&&{isAbsent:e.isAbsent}};t=(await Ee(x.value,l)).data}else t=(await Ue(x.value,e)).data;if(t&&typeof t=="object"&&(t.data&&Array.isArray(t.data)?d.value=t.data:t.records&&Array.isArray(t.records)?d.value=t.records:Array.isArray(t)&&(d.value=t)),t){const l=t.data||t;Array.isArray(l)?(d.value=l,h.value.itemCount=l.length):l&&typeof l=="object"&&"records"in l?(d.value=l.records||[],h.value.itemCount=l.total||0):(d.value=[],h.value.itemCount=0)}else d.value=[],h.value.itemCount=0}catch(e){console.error("获取考勤记录失败:",e),console.error("错误详情:",{message:e?.message,response:e?.response?.data,status:e?.response?.status}),window.$message?.error("获取考勤记录失败"),d.value=[],h.value.itemCount=0}finally{m.value=!1}}async function ge(){try{const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),1),l=new Date(e.getFullYear(),e.getMonth()+1,0),I={startDate:t.toISOString().split("T")[0],endDate:l.toISOString().split("T")[0]},{data:D}=await He(x.value,I);if(D){const ke=D.data||D;P.value=ke}else P.value={totalWorkDays:0,totalWorkHours:0,averageWorkHours:0,lateCount:0,absentCount:0,attendanceRate:0}}catch(e){console.error("获取考勤统计失败:",e),console.error("错误详情:",{message:e?.message,response:e?.response?.data,status:e?.response?.status}),P.value={totalWorkDays:0,totalWorkHours:0,averageWorkHours:0,lateCount:0,absentCount:0,attendanceRate:0}}}async function se(){if(m.value||k.value){k.value&&!_.value&&window.$message?.warning("今日已打卡，请先签退后再打卡");return}try{m.value=!0,A.value=0;const{data:e}=await qe(x.value);e?(window.$message?.success(e.message||"打卡成功！"),k.value=!0,A.value=0,await w()):window.$message?.warning("打卡响应异常，请刷新页面查看状态")}catch(e){if(console.error("打卡失败:",e),console.error("请求详情:",{riderId:x.value,url:e?.config?.url,method:e?.config?.method,data:e?.config?.data,headers:e?.config?.headers}),e?.response?.data?.message){const t=e.response.data.message;t.includes("已有考勤记录")||t.includes("已签到")||t.includes("重复")||t.includes("already")||t.includes("expected to affect 1 row")||t.includes("actually affected 0 row")||t.includes("乐观并发")||t.includes("concurrency")?(window.$message?.warning("检测到重复操作，正在刷新状态..."),await Promise.all([w(),M()]),v.value?.checkInAt&&(k.value=!0,window.$message?.success("今日已成功打卡！"))):window.$message?.error(`打卡失败：${t}`)}else if(e?.response?.status)switch(e.response.status){case 400:window.$message?.error("请求参数错误，请检查网络连接");break;case 401:window.$message?.error("登录已过期，请重新登录");break;case 403:window.$message?.error("没有权限进行此操作");break;case 409:if(A.value<J){A.value++,window.$message?.warning(`操作冲突，正在重试 (${A.value}/${J})...`),await new Promise(t=>setTimeout(t,1e3*A.value)),await se();return}else window.$message?.warning("操作冲突，正在刷新状态..."),await Promise.all([w(),M()]);break;case 500:window.$message?.error("服务器错误，请稍后重试");break;default:window.$message?.error("打卡失败，请稍后重试")}else window.$message?.error("网络连接失败，请检查网络后重试")}finally{m.value=!1}}async function ve(){await se()}async function ne(){if(!(m.value||_.value||!k.value))try{m.value=!0,S.value=0;const{data:e}=await Ye(x.value);e?(window.$message?.success(e.message||"签退成功！"),_.value=!0,S.value=0,await w()):window.$message?.warning("签退响应异常，请刷新页面查看状态")}catch(e){if(console.error("签退失败:",e),console.error("请求详情:",{riderId:x.value,url:e?.config?.url,method:e?.config?.method,data:e?.config?.data,headers:e?.config?.headers}),e?.response?.data?.message){const t=e.response.data.message;t.includes("未签到")||t.includes("not checked in")||t.includes("需要先签到")?window.$message?.error("请先完成签到再进行签退"):t.includes("已签退")||t.includes("already checked out")||t.includes("expected to affect 1 row")||t.includes("actually affected 0 row")||t.includes("乐观并发")||t.includes("concurrency")?(window.$message?.warning("检测到重复操作，正在刷新状态..."),await Promise.all([w(),M()]),v.value?.checkoutAt&&(_.value=!0,window.$message?.success("今日已成功签退！"))):window.$message?.error(`签退失败：${t}`)}else if(e?.response?.status)switch(e.response.status){case 400:window.$message?.error("请求参数错误，请检查网络连接");break;case 401:window.$message?.error("登录已过期，请重新登录");break;case 403:window.$message?.error("没有权限进行此操作");break;case 409:if(S.value<J){S.value++,window.$message?.warning(`操作冲突，正在重试 (${S.value}/${J})...`),await new Promise(t=>setTimeout(t,1e3*S.value)),await ne();return}else window.$message?.warning("操作冲突，正在刷新状态..."),await Promise.all([w(),M()]);break;case 500:window.$message?.error("服务器错误，请稍后重试");break;default:window.$message?.error("签退失败，请稍后重试")}else window.$message?.error("网络连接失败，请检查网络后重试")}finally{m.value=!1}}async function fe(){await ne()}async function pe(e){try{const{data:t}=await Ve(e.attendanceId);t&&t.data&&(g.value=t.data,B.value=!0)}catch(t){console.error("获取考勤详情失败:",t),window.$message?.error("获取考勤详情失败")}}function K(){h.value.page=1,w()}function ee(e){e==="startDate"?i.value.startDate=null:e==="endDate"?i.value.endDate=null:e==="status"&&(i.value.status=void 0),K()}function me(){i.value={startDate:null,endDate:null,status:void 0},h.value.page=1,w()}function he(e){h.value.page=e,w()}function xe(e){h.value.pageSize=e,h.value.page=1,w()}const U=V(()=>{if(!d.value||!Array.isArray(d.value))return{total:0,present:0,late:0,absent:0,attendanceRate:0};const e=d.value.length,t=d.value.filter(D=>D.isLate===0&&D.isAbsent===0).length,l=d.value.filter(D=>D.isLate===1).length,I=d.value.filter(D=>D.isAbsent===1).length;return{total:e,present:t,late:l,absent:I,attendanceRate:e>0?Math.round(t/e*100):0}}),te={present:{text:"正常",type:"success"},absent:{text:"缺勤",type:"error"},late:{text:"迟到",type:"warning"}},E=V(()=>{if(!v.value)return{canCheckIn:!0,canCheckOut:!1,statusText:"未打卡",statusType:"default"};const e=!!v.value.checkInAt,t=!!v.value.checkoutAt;return e&&t?{canCheckIn:!1,canCheckOut:!1,statusText:"已完成",statusType:"success"}:e&&!t?{canCheckIn:!1,canCheckOut:!0,statusText:"已打卡(未签退)",statusType:"warning"}:{canCheckIn:!0,canCheckOut:!1,statusText:"未打卡",statusType:"default"}});function ae(e){return e.isAbsent===1?"absent":e.isLate===1?"late":"present"}function le(e){if(!e.checkInAt||!e.checkoutAt)return 0;const t=new Date(e.checkInAt),l=new Date(e.checkoutAt);return Math.round((l.getTime()-t.getTime())/(1e3*60*60)*10)/10}const be=[{title:"日期",key:"checkDate",width:120,render:e=>{const t=new Date(e.checkDate),l=new Date,I=t.toDateString()===l.toDateString();return p("div",{class:"flex items-center"},[p("span",{class:I?"text-blue-600 font-medium":""},t.toLocaleDateString("zh-CN",{month:"2-digit",day:"2-digit"})),I&&p(T,{type:"primary",size:"tiny"},{default:()=>"今日"})])}},{title:"上班时间",key:"checkInAt",width:100,render:e=>{if(!e.checkInAt)return p("span",{class:"text-gray-400"},"未打卡");const t=new Date(e.checkInAt).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"});return p("span",{class:"font-medium"},t)}},{title:"下班时间",key:"checkoutAt",width:100,render:e=>{if(!e.checkoutAt)return p("span",{class:"text-gray-400"},"未签退");const t=new Date(e.checkoutAt).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"});return p("span",{class:"font-medium"},t)}},{title:"工作时长",key:"workHours",width:100,render:e=>{const t=le(e);return t===0?"-":p("span",{class:"text-green-600 font-medium"},`${t}h`)}},{title:"状态",key:"status",width:100,render:e=>{const t=ae(e),l=te[t];return p(T,{type:l.type,size:"small"},{default:()=>l.text})}},{title:"操作",key:"actions",width:80,render:e=>p(Q,{size:"small",type:"primary",ghost:!0,onClick:()=>pe(e)},{default:()=>"详情"})}],we=[{label:"全部状态",value:void 0},{label:"正常",value:"present"},{label:"迟到",value:"late"},{label:"缺勤",value:"absent"}],ye=V(()=>!!(i.value.startDate||i.value.endDate||i.value.status));return $e(async()=>{!o.userInfo.userId&&o.token&&await o.initUserInfo(),o.userInfo.userId||Object.assign(o.userInfo,{userId:`rider_${Date.now()}`,userName:"测试骑手",roles:["rider"],buttons:[]});try{await Promise.all([de(),M(),w(),ge()])}catch(e){console.error("数据获取过程中出现错误:",e)}setInterval(ce,1e3)}),(e,t)=>(C(),j("div",Qe,[n(s(z),{bordered:!1,class:"mb-24px bg-white/80 backdrop-blur-sm dark:bg-gray-800/80"},{default:r(()=>[a("div",Xe,[a("div",Ze,[n(s(R),{icon:"mdi:clock-check",class:"text-2xl text-white"})]),a("div",null,[a("h1",Ge,u(s(W)("rider.attendance.title")),1),a("p",Je,u(s(W)("rider.attendance.subtitle")),1)])])]),_:1}),n(s(z),{bordered:!1,class:"mb-24px rounded-16px bg-white/90 shadow-lg backdrop-blur-sm dark:bg-gray-800/90"},{default:r(()=>[a("div",Ke,[a("div",et,[a("div",tt,[a("div",at,u(F.value.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit"})),1),a("div",st,u(F.value.toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric",weekday:"long"})),1)]),a("div",nt,[a("div",lt,u(s(o).userInfo.userName||f.value?.name||"骑手"),1),a("div",rt,"车辆："+u(f.value?.vehicleNumber||"暂无"),1)]),a("div",ot,[a("div",it,u(E.value.statusText),1),a("div",ut,u(v.value?.checkInAt?`打卡时间: ${new Date(v.value.checkInAt).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})}`:"今日未打卡"),1),v.value?.checkoutAt?(C(),j("div",ct," 签退时间: "+u(new Date(v.value.checkoutAt).toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})),1)):$("",!0)])]),a("div",dt,[n(s(Q),{class:"px-32px",type:"primary",size:"large",disabled:!E.value.canCheckIn||m.value,loading:m.value,onClick:ve},{icon:r(()=>[n(s(R),{icon:"mdi:clock-check",class:"mr-8px"})]),default:r(()=>[y(" "+u(E.value.statusText),1)]),_:1},8,["disabled","loading"]),n(s(Q),{class:"px-32px",type:"info",size:"large",disabled:!E.value.canCheckOut||m.value,loading:m.value,onClick:fe},{icon:r(()=>[n(s(R),{icon:"mdi:clock-out",class:"mr-8px"})]),default:r(()=>[y(" "+u(_.value?"已签退":"签退"),1)]),_:1},8,["disabled","loading"])])])]),_:1}),n(s(oe),{cols:"s:2 m:4",responsive:"screen","x-gap":20,"y-gap":20,class:"mb-24px"},{default:r(()=>[n(s(N),null,{default:r(()=>[n(s(z),{bordered:!1,class:"stat-card stat-card-blue text-center bg-gradient-to-br from-blue-50 to-blue-100 dark:from-blue-900/30 dark:to-blue-800/30 backdrop-blur-sm shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer rounded-16px"},{default:r(()=>[a("div",gt,[a("div",vt,[n(s(R),{icon:"mdi:calendar-check",class:"stat-icon"})]),n(s(G),{label:"出勤天数",value:U.value.total,class:"stat-value","label-style":{color:"#6B7280",fontSize:"14px",fontWeight:"500"},"value-style":{color:"#1F2937",fontSize:"32px",fontWeight:"700"}},null,8,["value"])]),t[6]||(t[6]=a("div",{class:"stat-card-decoration"},null,-1))]),_:1,__:[6]})]),_:1}),n(s(N),null,{default:r(()=>[n(s(z),{bordered:!1,class:"stat-card stat-card-green text-center bg-gradient-to-br from-green-50 to-green-100 dark:from-green-900/30 dark:to-green-800/30 backdrop-blur-sm shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer rounded-16px"},{default:r(()=>[a("div",ft,[a("div",pt,[n(s(R),{icon:"mdi:check-circle",class:"stat-icon"})]),n(s(G),{label:"正常出勤",value:U.value.present,class:"stat-value","label-style":{color:"#6B7280",fontSize:"14px",fontWeight:"500"},"value-style":{color:"#1F2937",fontSize:"32px",fontWeight:"700"}},null,8,["value"])]),t[7]||(t[7]=a("div",{class:"stat-card-decoration"},null,-1))]),_:1,__:[7]})]),_:1}),n(s(N),null,{default:r(()=>[n(s(z),{bordered:!1,class:"stat-card stat-card-orange text-center bg-gradient-to-br from-orange-50 to-orange-100 dark:from-orange-900/30 dark:to-orange-800/30 backdrop-blur-sm shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer rounded-16px"},{default:r(()=>[a("div",mt,[a("div",ht,[n(s(R),{icon:"mdi:clock-alert",class:"stat-icon"})]),n(s(G),{label:"迟到次数",value:U.value.late,class:"stat-value","label-style":{color:"#6B7280",fontSize:"14px",fontWeight:"500"},"value-style":{color:"#1F2937",fontSize:"32px",fontWeight:"700"}},null,8,["value"])]),t[8]||(t[8]=a("div",{class:"stat-card-decoration"},null,-1))]),_:1,__:[8]})]),_:1}),n(s(N),null,{default:r(()=>[n(s(z),{bordered:!1,class:"stat-card stat-card-purple text-center bg-gradient-to-br from-purple-50 to-purple-100 dark:from-purple-900/30 dark:to-purple-800/30 backdrop-blur-sm shadow-lg hover:shadow-xl transition-all duration-300 cursor-pointer rounded-16px"},{default:r(()=>[a("div",xt,[a("div",bt,[n(s(R),{icon:"mdi:percent",class:"stat-icon"})]),n(s(G),{label:"出勤率",value:U.value.attendanceRate,suffix:"%",class:"stat-value","label-style":{color:"#6B7280",fontSize:"14px",fontWeight:"500"},"value-style":{color:"#1F2937",fontSize:"32px",fontWeight:"700"}},null,8,["value"])]),t[9]||(t[9]=a("div",{class:"stat-card-decoration"},null,-1))]),_:1,__:[9]})]),_:1})]),_:1}),n(s(z),{bordered:!1,class:"mb-24px rounded-16px bg-white/90 shadow-lg backdrop-blur-sm dark:bg-gray-800/90"},{default:r(()=>[n(s(oe),{cols:24,"x-gap":16,"y-gap":16},{default:r(()=>[n(s(N),{span:8},{default:r(()=>[a("div",null,[t[10]||(t[10]=a("label",{class:"mb-8px block text-sm text-gray-600 dark:text-gray-400"},"开始日期",-1)),n(s(re),{value:i.value.startDate,"onUpdate:value":[t[0]||(t[0]=l=>i.value.startDate=l),K],type:"date",placeholder:"选择开始日期",clearable:"",class:"w-full"},null,8,["value"])])]),_:1}),n(s(N),{span:8},{default:r(()=>[a("div",null,[t[11]||(t[11]=a("label",{class:"mb-8px block text-sm text-gray-600 dark:text-gray-400"},"结束日期",-1)),n(s(re),{value:i.value.endDate,"onUpdate:value":[t[1]||(t[1]=l=>i.value.endDate=l),K],type:"date",placeholder:"选择结束日期",clearable:"",class:"w-full"},null,8,["value"])])]),_:1}),n(s(N),{span:8},{default:r(()=>[a("div",wt,[n(s(Be),null,{default:r(()=>[n(s(Q),{type:"primary",onClick:me},{default:r(()=>t[12]||(t[12]=[y("重置")])),_:1,__:[12]})]),_:1})])]),_:1})]),_:1})]),_:1}),n(s(z),{bordered:!1,class:"rounded-16px bg-white/90 shadow-lg backdrop-blur-sm dark:bg-gray-800/90"},{header:r(()=>[a("div",yt,[a("div",null,[t[13]||(t[13]=a("span",{class:"text-lg font-semibold text-gray-800 dark:text-gray-200"},"考勤记录",-1)),ye.value?(C(),j("div",kt,[i.value.startDate?(C(),X(s(T),{key:0,size:"small",type:"info",closable:"",onClose:t[2]||(t[2]=l=>ee("startDate"))},{default:r(()=>[y(" 开始: "+u(new Date(i.value.startDate).toLocaleDateString("zh-CN")),1)]),_:1})):$("",!0),i.value.endDate?(C(),X(s(T),{key:1,size:"small",type:"info",closable:"",onClose:t[3]||(t[3]=l=>ee("endDate"))},{default:r(()=>[y(" 结束: "+u(new Date(i.value.endDate).toLocaleDateString("zh-CN")),1)]),_:1})):$("",!0),i.value.status?(C(),X(s(T),{key:2,size:"small",type:"warning",closable:"",onClose:t[4]||(t[4]=l=>ee("status"))},{default:r(()=>[y(" 状态: "+u(we.find(l=>l.value===i.value.status)?.label),1)]),_:1})):$("",!0)])):$("",!0)]),a("span",_t,"共 "+u(h.value.itemCount)+" 条记录",1)])]),default:r(()=>[n(s(Oe),{show:m.value},{default:r(()=>[n(s(We),{columns:be,data:d.value,pagination:{page:h.value.page,pageSize:h.value.pageSize,itemCount:h.value.itemCount,showSizePicker:!0,pageSizes:[10,15,20,30],onUpdatePage:he,onUpdatePageSize:xe},bordered:!1,"single-line":!1,class:"mt-16px"},null,8,["data","pagination"]),!m.value&&d.value.length===0?(C(),X(s(Te),{key:0,description:"暂无考勤记录"})):$("",!0)]),_:1},8,["show"])]),_:1}),n(s(Re),{show:B.value,"onUpdate:show":t[5]||(t[5]=l=>B.value=l),preset:"card",title:"考勤详情",class:"w-[600px]"},{default:r(()=>[g.value?(C(),j("div",Dt,[a("div",Ct,[a("div",At,[t[14]||(t[14]=a("div",{class:"text-sm text-gray-500"},"日期",-1)),a("div",St,u(new Date(g.value.checkDate).toLocaleDateString("zh-CN")),1)]),a("div",It,[t[15]||(t[15]=a("div",{class:"text-sm text-gray-500"},"状态",-1)),n(s(T),{type:te[ae(g.value)].type,size:"medium"},{default:r(()=>[y(u(te[ae(g.value)].text),1)]),_:1},8,["type"])])]),a("div",zt,[a("div",$t,[t[16]||(t[16]=a("div",{class:"text-sm text-blue-600 dark:text-blue-400"},"上班时间",-1)),a("div",Tt,u(g.value.checkInAt?new Date(g.value.checkInAt).toLocaleTimeString("zh-CN"):"未打卡"),1)]),a("div",Rt,[t[17]||(t[17]=a("div",{class:"text-sm text-green-600 dark:text-green-400"},"下班时间",-1)),a("div",Nt,u(g.value.checkoutAt?new Date(g.value.checkoutAt).toLocaleTimeString("zh-CN"):"未签退"),1)])]),g.value.checkInAt&&g.value.checkoutAt?(C(),j("div",Lt,[t[18]||(t[18]=a("div",{class:"text-sm text-purple-600 dark:text-purple-400"},"工作时长",-1)),a("div",Ot,u(le(g.value))+" 小时 ",1)])):$("",!0),n(s(Pe),{"label-placement":"left",bordered:"",column:1},{default:r(()=>[n(s(Z),{label:"考勤ID"},{default:r(()=>[y(u(g.value.attendanceId),1)]),_:1}),n(s(Z),{label:"骑手ID"},{default:r(()=>[y(u(g.value.riderId),1)]),_:1}),n(s(Z),{label:"是否迟到"},{default:r(()=>[n(s(T),{type:g.value.isLate?"warning":"success",size:"small"},{default:r(()=>[y(u(g.value.isLate?"是":"否"),1)]),_:1},8,["type"])]),_:1}),n(s(Z),{label:"是否缺勤"},{default:r(()=>[n(s(T),{type:g.value.isAbsent?"error":"success",size:"small"},{default:r(()=>[y(u(g.value.isAbsent?"是":"否"),1)]),_:1},8,["type"])]),_:1})]),_:1})])):$("",!0)]),_:1},8,["show"])]))}}),Vt=Le(Wt,[["__scopeId","data-v-f6e19c5f"]]);export{Vt as default};
