import{r as K,a as C,i as Z,j as J,d as L,k as V,b as M,o as b,e as d,$ as o,l as X,m as Q,u as I,n as q,c as S,w as l,f as n,p as B,q as E,h as e,s as Y,g as v,t as y,B as F,v as R,x as ee,F as oe,y as ne,z as U,A as j,C as te,D as se,E as le,G as ae,H as re,I as ie,J as ce,K as de,T as ue,L as pe,M as me,N as ge}from"./index-DSqQRdfM.js";import{_ as G}from"./Space-DnyABEot.js";import{_ as T}from"./Form-Beo7jV4f.js";function fe(p){const r=K(0),m=C(()=>Math.ceil(r.value)),i=C(()=>r.value>0),{pause:c,resume:a}=Z(({delta:s})=>{if(r.value<=0){r.value=0,c();return}const w=s/1e3;r.value-=w,r.value<=0&&(r.value=0,c())},{immediate:!1});function x(s=p){r.value=s,a()}function _(){r.value=0,c()}return J(()=>{c()}),{count:m,isCounting:i,start:x,stop:_}}const _e={class:"absolute-lt z-1 size-full overflow-hidden"},we={class:"absolute -right-300px -top-900px lt-sm:-right-100px lt-sm:-top-1170px"},he={height:"1337",width:"1337"},ve={id:"linearGradient-2",x1:"0.79",y1:"0.62",x2:"0.21",y2:"0.86"},ye=["stop-color"],xe=["stop-color"],ke={class:"absolute -bottom-400px -left-200px lt-sm:-bottom-760px lt-sm:-left-100px"},Ce={height:"896",width:"967.8852157128662"},be={id:"linearGradient-3",x1:"0.5",y1:"0",x2:"0.5",y2:"1"},Ne=["stop-color"],$e=["stop-color"],Pe=L({name:"WaveBg",__name:"wave-bg",props:{themeColor:{}},setup(p){const r=p,m=C(()=>V(r.themeColor,200)),i=C(()=>V(r.themeColor,500));return(c,a)=>(b(),M("div",_e,[d("div",we,[(b(),M("svg",he,[d("defs",null,[a[0]||(a[0]=d("path",{id:"path-1",opacity:"1","fill-rule":"evenodd",d:"M1337,668.5 C1337,1037.455193874239 1037.455193874239,1337 668.5,1337 C523.6725684305388,1337 337,1236 370.50000000000006,1094 C434.03835568300906,824.6732385973953 6.906089672974592e-14,892.6277623047779 0,668.5000000000001 C0,299.5448061257611 299.5448061257609,1.1368683772161603e-13 668.4999999999999,0 C1037.455193874239,0 1337,299.544806125761 1337,668.5Z"},null,-1)),d("linearGradient",ve,[d("stop",{offset:"0","stop-color":m.value,"stop-opacity":"1"},null,8,ye),d("stop",{offset:"1","stop-color":i.value,"stop-opacity":"1"},null,8,xe)])]),a[1]||(a[1]=d("g",{opacity:"1"},[d("use",{"xlink:href":"#path-1",fill:"url(#linearGradient-2)","fill-opacity":"1"})],-1))]))]),d("div",ke,[(b(),M("svg",Ce,[d("defs",null,[a[2]||(a[2]=d("path",{id:"path-2",opacity:"1","fill-rule":"evenodd",d:"M896,448 C1142.6325445712241,465.5747656464056 695.2579309733121,896 448,896 C200.74206902668806,896 5.684341886080802e-14,695.2579309733121 0,448.0000000000001 C0,200.74206902668806 200.74206902668791,5.684341886080802e-14 447.99999999999994,0 C695.2579309733121,0 475,418 896,448Z"},null,-1)),d("linearGradient",be,[d("stop",{offset:"0","stop-color":i.value,"stop-opacity":"1"},null,8,Ne),d("stop",{offset:"1","stop-color":m.value,"stop-opacity":"1"},null,8,$e)])]),a[3]||(a[3]=d("g",{opacity:"1"},[d("use",{"xlink:href":"#path-2",fill:"url(#linearGradient-3)","fill-opacity":"1"})],-1))]))])]))}}),Re=/^[\u4E00-\u9FA5a-zA-Z0-9_-]{4,16}$/,O=/^[1](([3][0-9])|([4][01456789])|([5][012356789])|([6][2567])|([7][0-8])|([8][0-9])|([9][012356789]))[0-9]{8}$/,Se=/^\w{6,18}$/,Le=/^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,ze=/^\d{6}$/;function A(){const p={userName:{pattern:Re,message:o("form.userName.invalid"),trigger:"change"},phone:{pattern:O,message:o("form.phone.invalid"),trigger:"change"},pwd:{pattern:Se,message:o("form.pwd.invalid"),trigger:"change"},code:{pattern:ze,message:o("form.code.invalid"),trigger:"change"},email:{pattern:Le,message:o("form.email.invalid"),trigger:"change"}},r={userName:[i(o("form.userName.required")),p.userName],phone:[i(o("form.phone.required")),p.phone],pwd:[i(o("form.pwd.required")),p.pwd],code:[i(o("form.code.required")),p.code],email:[i(o("form.email.required")),p.email]},m=i(o("form.required"));function i(a){return{required:!0,message:a}}function c(a){return[{required:!0,message:o("form.confirmPwd.required")},{asyncValidator:(_,s)=>s.trim()!==""&&s!==X(a)?Promise.reject(_.message):Promise.resolve(),message:o("form.confirmPwd.invalid"),trigger:"input"}]}return{patternRules:p,formRules:r,defaultRequiredRule:m,createRequiredRule:i,createConfirmPwdRule:c}}function D(){const p=K(null);async function r(){await p.value?.validate()}async function m(){p.value?.restoreValidation()}return{formRef:p,validate:r,restoreValidation:m}}const Me={class:"flex-y-center justify-between"},Ie={class:"flex-y-center justify-between gap-12px"},qe={class:"flex-center gap-12px"},Be=L({name:"PwdLogin",__name:"pwd-login",setup(p){const r=Q(),{toggleLoginModule:m}=I(),{formRef:i,validate:c}=D(),a=q({userName:"Soybean",password:"123456"}),x=C(()=>{const{formRules:u}=A();return{userName:u.userName,password:u.pwd}});async function _(){await c(),await r.login(a.userName,a.password)}const s=C(()=>[{key:"super",label:o("page.login.pwdLogin.superAdmin"),userName:"Super",password:"123456"},{key:"admin",label:o("page.login.pwdLogin.admin"),userName:"Admin",password:"123456"},{key:"user",label:o("page.login.pwdLogin.user"),userName:"User",password:"123456"}]);async function w(u){await r.login(u.userName,u.password)}async function g(){try{const u=`mock_dev_token_${Date.now()}`,t=`mock_dev_refresh_token_${Date.now()}`;j.set("token",u),j.set("refreshToken",t),Object.assign(r.userInfo,{userId:"mock_user_001",userName:"测试骑手",roles:["rider"],buttons:[]}),window.$message?.success("开发者模式登录成功"),setTimeout(()=>{window.location.href="/"},800)}catch(u){window.$message?.error("开发者模式登录失败"),console.error(u)}}return(u,t)=>{const k=E,f=B,P=Y,N=F,z=ee,h=G,H=T;return b(),S(H,{ref_key:"formRef",ref:i,model:a,rules:x.value,size:"large","show-label":!1,onKeyup:U(_,["enter"])},{default:l(()=>[n(f,{path:"userName"},{default:l(()=>[n(k,{value:a.userName,"onUpdate:value":t[0]||(t[0]=$=>a.userName=$),placeholder:e(o)("page.login.common.userNamePlaceholder")},null,8,["value","placeholder"])]),_:1}),n(f,{path:"password"},{default:l(()=>[n(k,{value:a.password,"onUpdate:value":t[1]||(t[1]=$=>a.password=$),type:"password","show-password-on":"click",placeholder:e(o)("page.login.common.passwordPlaceholder")},null,8,["value","placeholder"])]),_:1}),n(h,{vertical:"",size:24},{default:l(()=>[d("div",Me,[n(P,null,{default:l(()=>[v(y(e(o)("page.login.pwdLogin.rememberMe")),1)]),_:1}),n(N,{quaternary:"",onClick:t[2]||(t[2]=$=>e(m)("reset-pwd"))},{default:l(()=>[v(y(e(o)("page.login.pwdLogin.forgetPassword")),1)]),_:1})]),n(N,{type:"primary",size:"large",round:"",block:"",loading:e(r).loginLoading,onClick:_},{default:l(()=>[v(y(e(o)("common.confirm")),1)]),_:1},8,["loading"]),d("div",Ie,[n(N,{class:"flex-1",block:"",onClick:t[3]||(t[3]=$=>e(m)("code-login"))},{default:l(()=>[v(y(e(o)(e(R)["code-login"])),1)]),_:1}),n(N,{class:"flex-1",block:"",onClick:t[4]||(t[4]=$=>e(m)("register"))},{default:l(()=>[v(y(e(o)(e(R).register)),1)]),_:1})]),n(z,{class:"text-14px text-#666 !m-0"},{default:l(()=>[v(y(e(o)("page.login.pwdLogin.otherAccountLogin")),1)]),_:1}),d("div",qe,[(b(!0),M(oe,null,ne(s.value,$=>(b(),S(N,{key:$.key,type:"primary",onClick:Ze=>w($)},{default:l(()=>[v(y($.label),1)]),_:2},1032,["onClick"]))),128))]),n(z,{class:"text-14px text-orange-500 !m-0"},{default:l(()=>t[5]||(t[5]=[v("开发者模式 (仅用于前端开发)")])),_:1,__:[5]}),n(N,{type:"warning",block:"",onClick:g},{default:l(()=>t[6]||(t[6]=[v("绕过API直接登录 (开发模式)")])),_:1,__:[6]})]),_:1})]),_:1},8,["model","rules"])}}});function W(){const{loading:p,startLoading:r,endLoading:m}=te(),{count:i,start:c,stop:a,isCounting:x}=fe(10),_=C(()=>{let g=o("page.login.codeLogin.getCode");const u=o("page.login.codeLogin.reGetCode",{time:i.value});return p.value&&(g=""),x.value&&(g=u),g});function s(g){return g.trim()===""?(window.$message?.error?.(o("form.phone.required")),!1):O.test(g)?!0:(window.$message?.error?.(o("form.phone.invalid")),!1)}async function w(g){!s(g)||p.value||(r(),await new Promise(t=>{setTimeout(t,500)}),window.$message?.success?.(o("page.login.codeLogin.sendCodeSuccess")),c(),m())}return{label:_,start:c,stop:a,isCounting:x,loading:p,getCaptcha:w}}const Ee={class:"w-full flex-y-center gap-16px"},Fe=L({name:"CodeLogin",__name:"code-login",setup(p){const{toggleLoginModule:r}=I(),{formRef:m,validate:i}=D(),{label:c,isCounting:a,loading:x,getCaptcha:_}=W(),s=q({phone:"",code:""}),w=C(()=>{const{formRules:u}=A();return{phone:u.phone,code:u.code}});async function g(){await i(),window.$message?.success(o("page.login.common.validateSuccess"))}return(u,t)=>{const k=E,f=B,P=F,N=G,z=T;return b(),S(z,{ref_key:"formRef",ref:m,model:s,rules:w.value,size:"large","show-label":!1,onKeyup:U(g,["enter"])},{default:l(()=>[n(f,{path:"phone"},{default:l(()=>[n(k,{value:s.phone,"onUpdate:value":t[0]||(t[0]=h=>s.phone=h),placeholder:e(o)("page.login.common.phonePlaceholder")},null,8,["value","placeholder"])]),_:1}),n(f,{path:"code"},{default:l(()=>[d("div",Ee,[n(k,{value:s.code,"onUpdate:value":t[1]||(t[1]=h=>s.code=h),placeholder:e(o)("page.login.common.codePlaceholder")},null,8,["value","placeholder"]),n(P,{size:"large",disabled:e(a),loading:e(x),onClick:t[2]||(t[2]=h=>e(_)(s.phone))},{default:l(()=>[v(y(e(c)),1)]),_:1},8,["disabled","loading"])])]),_:1}),n(N,{vertical:"",size:18,class:"w-full"},{default:l(()=>[n(P,{type:"primary",size:"large",round:"",block:"",onClick:g},{default:l(()=>[v(y(e(o)("common.confirm")),1)]),_:1}),n(P,{size:"large",round:"",block:"",onClick:t[3]||(t[3]=h=>e(r)("pwd-login"))},{default:l(()=>[v(y(e(o)("page.login.common.back")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])}}}),Ue={class:"w-full flex-y-center gap-16px"},Ge=L({name:"Register",__name:"register",setup(p){const{toggleLoginModule:r}=I(),{formRef:m,validate:i}=D(),{label:c,isCounting:a,loading:x,getCaptcha:_}=W(),s=q({phone:"",code:"",password:"",confirmPassword:""}),w=C(()=>{const{formRules:u,createConfirmPwdRule:t}=A();return{phone:u.phone,code:u.code,password:u.pwd,confirmPassword:t(s.password)}});async function g(){await i(),window.$message?.success(o("page.login.common.validateSuccess"))}return(u,t)=>{const k=E,f=B,P=F,N=G,z=T;return b(),S(z,{ref_key:"formRef",ref:m,model:s,rules:w.value,size:"large","show-label":!1,onKeyup:U(g,["enter"])},{default:l(()=>[n(f,{path:"phone"},{default:l(()=>[n(k,{value:s.phone,"onUpdate:value":t[0]||(t[0]=h=>s.phone=h),placeholder:e(o)("page.login.common.phonePlaceholder")},null,8,["value","placeholder"])]),_:1}),n(f,{path:"code"},{default:l(()=>[d("div",Ue,[n(k,{value:s.code,"onUpdate:value":t[1]||(t[1]=h=>s.code=h),placeholder:e(o)("page.login.common.codePlaceholder")},null,8,["value","placeholder"]),n(P,{size:"large",disabled:e(a),loading:e(x),onClick:t[2]||(t[2]=h=>e(_)(s.phone))},{default:l(()=>[v(y(e(c)),1)]),_:1},8,["disabled","loading"])])]),_:1}),n(f,{path:"password"},{default:l(()=>[n(k,{value:s.password,"onUpdate:value":t[3]||(t[3]=h=>s.password=h),type:"password","show-password-on":"click",placeholder:e(o)("page.login.common.passwordPlaceholder")},null,8,["value","placeholder"])]),_:1}),n(f,{path:"confirmPassword"},{default:l(()=>[n(k,{value:s.confirmPassword,"onUpdate:value":t[4]||(t[4]=h=>s.confirmPassword=h),type:"password","show-password-on":"click",placeholder:e(o)("page.login.common.confirmPasswordPlaceholder")},null,8,["value","placeholder"])]),_:1}),n(N,{vertical:"",size:18,class:"w-full"},{default:l(()=>[n(P,{type:"primary",size:"large",round:"",block:"",onClick:g},{default:l(()=>[v(y(e(o)("common.confirm")),1)]),_:1}),n(P,{size:"large",round:"",block:"",onClick:t[5]||(t[5]=h=>e(r)("pwd-login"))},{default:l(()=>[v(y(e(o)("page.login.common.back")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])}}}),Te=L({name:"ResetPwd",__name:"reset-pwd",setup(p){const{toggleLoginModule:r}=I(),{formRef:m,validate:i}=D(),c=q({phone:"",code:"",password:"",confirmPassword:""}),a=C(()=>{const{formRules:_,createConfirmPwdRule:s}=A();return{phone:_.phone,password:_.pwd,confirmPassword:s(c.password)}});async function x(){await i(),window.$message?.success(o("page.login.common.validateSuccess"))}return(_,s)=>{const w=E,g=B,u=F,t=G,k=T;return b(),S(k,{ref_key:"formRef",ref:m,model:c,rules:a.value,size:"large","show-label":!1,onKeyup:U(x,["enter"])},{default:l(()=>[n(g,{path:"phone"},{default:l(()=>[n(w,{value:c.phone,"onUpdate:value":s[0]||(s[0]=f=>c.phone=f),placeholder:e(o)("page.login.common.phonePlaceholder")},null,8,["value","placeholder"])]),_:1}),n(g,{path:"code"},{default:l(()=>[n(w,{value:c.code,"onUpdate:value":s[1]||(s[1]=f=>c.code=f),placeholder:e(o)("page.login.common.codePlaceholder")},null,8,["value","placeholder"])]),_:1}),n(g,{path:"password"},{default:l(()=>[n(w,{value:c.password,"onUpdate:value":s[2]||(s[2]=f=>c.password=f),type:"password","show-password-on":"click",placeholder:e(o)("page.login.common.passwordPlaceholder")},null,8,["value","placeholder"])]),_:1}),n(g,{path:"confirmPassword"},{default:l(()=>[n(w,{value:c.confirmPassword,"onUpdate:value":s[3]||(s[3]=f=>c.confirmPassword=f),type:"password","show-password-on":"click",placeholder:e(o)("page.login.common.confirmPasswordPlaceholder")},null,8,["value","placeholder"])]),_:1}),n(t,{vertical:"",size:18,class:"w-full"},{default:l(()=>[n(u,{type:"primary",size:"large",round:"",block:"",onClick:x},{default:l(()=>[v(y(e(o)("common.confirm")),1)]),_:1}),n(u,{size:"large",round:"",block:"",onClick:s[4]||(s[4]=f=>e(r)("pwd-login"))},{default:l(()=>[v(y(e(o)("page.login.common.back")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])}}}),Ae=L({name:"BindWechat",__name:"bind-wechat",setup(p){return(r,m)=>(b(),M("div"))}}),De={class:"w-400px lt-sm:w-300px"},Ve={class:"flex-y-center justify-between"},je={class:"text-28px text-primary font-500 lt-sm:text-22px"},Ke={class:"i-flex-col"},Oe={class:"pt-24px"},We={class:"text-18px text-primary font-medium"},He={class:"pt-24px"},Ye=L({name:"login",__name:"index",props:{module:{}},setup(p){const r=p,m=se(),i=le(),c={"pwd-login":{label:R["pwd-login"],component:Be},"code-login":{label:R["code-login"],component:Fe},register:{label:R.register,component:Ge},"reset-pwd":{label:R["reset-pwd"],component:Te},"bind-wechat":{label:R["bind-wechat"],component:Ae}},a=C(()=>c[r.module||"pwd-login"]),x=C(()=>i.darkMode?V(i.themeColor,600):i.themeColor),_=C(()=>{const s="#ffffff",w=i.darkMode?.5:.2;return ae(s,i.themeColor,w)});return(s,w)=>{const g=Pe,u=re,t=ce,k=de,f=me;return b(),M("div",{class:"relative size-full flex-center overflow-hidden",style:ge({backgroundColor:_.value})},[n(g,{"theme-color":x.value},null,8,["theme-color"]),n(f,{bordered:!1,class:"relative z-4 w-auto rd-12px"},{default:l(()=>[d("div",De,[d("header",Ve,[n(u,{class:"text-64px text-primary lt-sm:text-48px"}),d("h3",je,y(e(o)("system.title")),1),d("div",Ke,[n(t,{"theme-schema":e(i).themeScheme,"show-tooltip":!1,class:"text-20px lt-sm:text-18px",onSwitch:e(i).toggleThemeScheme},null,8,["theme-schema","onSwitch"]),e(i).header.multilingual.visible?(b(),S(k,{key:0,lang:e(m).locale,"lang-options":e(m).localeOptions,"show-tooltip":!1,onChangeLang:e(m).changeLocale},null,8,["lang","lang-options","onChangeLang"])):ie("",!0)])]),d("main",Oe,[d("h3",We,y(e(o)(a.value.label)),1),d("div",He,[n(ue,{name:e(i).page.animateMode,mode:"out-in",appear:""},{default:l(()=>[(b(),S(pe(a.value.component)))]),_:1},8,["name"])])])])]),_:1})],4)}}});export{Ye as default};
