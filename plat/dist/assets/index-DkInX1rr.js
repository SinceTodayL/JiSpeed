import{f as fe,b as pe,c as ge}from"./rider-mR7EWSRR.js";import{B as C}from"./BicycleOutline-Cedn2USk.js";import{d as V,b,o as m,aA as me,e as o,O as ve,r as w,a as J,P as he,f as e,g as c,w as l,h as t,Q as r,J as x,N as ye,R as xe,B as O,t as p,E as _e,c as A,F as K,v as Q,ae as be,s as X,U as we,X as ke}from"./index-BsgEjG81.js";import{P as q}from"./PauseCircleOutline-Dhwukw3U.js";import{T as W}from"./TimeOutline-CHZK-lm5.js";import{S as B}from"./StatsChartOutline-CwbMFG0f.js";import{N as I,S as ze,R as Z,a as Ne,b as v,c as ee}from"./SearchOutline-JLdD_p9w.js";import{T as U}from"./TrophyOutline-oaINcM4E.js";import{C as te}from"./CallOutline-LTdREXm_.js";import{P as L}from"./PersonOutline-BTf3Skrb.js";import{N as _,a as P}from"./Grid-D6_4mMTp.js";import{b as Re,N as ae,a as le}from"./FormItem-CT3gVn5C.js";import{_ as S}from"./Badge-DVpbrA-2.js";import{N as Ce}from"./Spin-DLsHec-K.js";const Ie={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},se=V({name:"CarOutline",render:function(k,h){return m(),b("svg",Ie,h[0]||(h[0]=[me('<path d="M80 224l37.78-88.15C123.93 121.5 139.6 112 157.11 112h197.78c17.51 0 33.18 9.5 39.33 23.85L432 224" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M80 224h352v144H80z"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M112 368v32H80v-32"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M432 368v32h-32v-32"></path><circle cx="144" cy="288" r="16" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></circle><circle cx="368" cy="288" r="16" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></circle>',6)]))}}),Se={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},oe=V({name:"FlashOutline",render:function(k,h){return m(),b("svg",Se,h[0]||(h[0]=[o("path",{d:"M315.27 33L96 304h128l-31.51 173.23a2.36 2.36 0 0 0 2.33 2.77h0a2.36 2.36 0 0 0 1.89-.95L416 208H288l31.66-173.25a2.45 2.45 0 0 0-2.44-2.75h0a2.42 2.42 0 0 0-1.95 1z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1)]))}}),Te={class:"p-6 min-h-full bg-gradient-to-br from-orange-50 to-yellow-50"},je={class:"mb-6"},Oe={class:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-2"},Pe={class:"flex items-center gap-2"},Me={class:"flex items-center gap-3"},De={class:"text-lg font-semibold text-gray-800"},Ae={class:"text-sm text-gray-500"},Be={key:0,class:"space-y-6"},Ue={class:"bg-gradient-to-r from-orange-50 to-yellow-50 p-4 rounded-lg"},Le={class:"text-gray-800 font-medium mb-4 flex items-center gap-2"},Ve={class:"text-center"},Fe={class:"text-sm text-gray-600"},Ee={key:1,class:"text-center py-8"},$e={class:"space-y-4"},Ge={class:"flex justify-between items-center py-2 border-b border-gray-100"},He={class:"flex justify-between items-center py-2 border-b border-gray-100"},Ye={class:"flex justify-between items-center py-2 border-b border-gray-100"},Je={class:"text-gray-600 font-medium flex items-center gap-2"},Ke={class:"flex justify-between items-center py-2"},Qe={class:"text-gray-600 font-medium flex items-center gap-2"},Xe={class:"space-y-4"},qe={class:"flex justify-between items-start py-2 border-b border-gray-100"},We={class:"flex justify-between items-center py-2 border-b border-gray-100"},Ze={class:"flex justify-between items-center py-2"},et={key:0},tt={class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},at={class:"flex items-center gap-2"},lt={class:"text-gray-700 font-medium"},st={key:1,class:"flex justify-center items-center h-80"},ot=V({name:"rider-manage",__name:"index",setup(F){const k=ve(),h=w(!1),g=w([]),N=w({page:1,pageSize:20,totalCount:0,totalPages:0}),d=w({searchTerm:"",status:null,page:1,pageSize:20}),ne=[{label:"全部状态",value:null},{label:"在线配送",value:1},{label:"离线休息",value:0},{label:"忙碌配送",value:2}],R=J(()=>{const s=g.value.length,a=g.value.filter(y=>y.status===1).length,n=g.value.filter(y=>y.status===0).length,u=g.value.filter(y=>y.status===2).length,f=g.value.filter(y=>y.vehicleNumber).length;return{total:s,onlineCount:a,offlineCount:n,busyCount:u,withVehicle:f,onlineRate:s>0?Math.round(a/s*100):0,vehicleRate:s>0?Math.round(f/s*100):0}}),M=J(()=>g.value.filter(s=>{if(d.value.searchTerm){const a=d.value.searchTerm.toLowerCase();if(!s.name?.toLowerCase().includes(a)&&!s.phoneNumber?.toLowerCase().includes(a))return!1}return!(d.value.status!==null&&s.status!==d.value.status)})),T=w(!1),D=w(!1),i=w({}),z=w({}),E=new Date,$=E.getFullYear(),G=E.getMonth()+1;async function H(){try{h.value=!0;const s={page:d.value.page,pageSize:d.value.pageSize};d.value.searchTerm&&(s.searchTerm=d.value.searchTerm),d.value.status!==null&&(s.status=d.value.status),console.log("🚀 开始请求骑手列表，参数:",s);const a=await fe(s);if(console.log("📥 收到骑手列表响应:",a),a&&a.data){console.log("详细的响应数据结构:",a.data);let n=null,u=null;a.data.Riders&&Array.isArray(a.data.Riders)?(n=a.data.Riders,u=a.data.Pagination):a.data.riders&&Array.isArray(a.data.riders)?(n=a.data.riders,u=a.data.pagination):Array.isArray(a.data)&&(n=a.data,u=null),console.log("解析出的骑手数据:",n),console.log("解析出的分页信息:",u),n&&Array.isArray(n)?(g.value=n.map((f,y)=>({...f,index:(N.value.page-1)*N.value.pageSize+y+1,riderId:f.riderId||f.RiderId||"-",name:f.name||f.Name||"-",phoneNumber:f.phoneNumber||f.PhoneNumber||"-",vehicleNumber:f.vehicleNumber||f.VehicleNumber||"-",applicationUserId:f.applicationUserId||f.ApplicationUserId||"-"})),console.log("处理后的表格数据:",g.value),u?N.value={page:u.page||u.Page||1,pageSize:u.pageSize||u.PageSize||20,totalCount:u.totalCount||u.TotalCount||0,totalPages:u.totalPages||u.TotalPages||0}:(N.value.totalCount=n.length,N.value.totalPages=Math.ceil(n.length/N.value.pageSize))):(console.log("没有找到有效的骑手数据数组"),g.value=[])}else k.error(a?.message||"获取骑手列表失败"),g.value=[]}catch(s){k.error("获取骑手列表失败: "+s.message),g.value=[],console.error("Error fetching riders list:",s)}finally{h.value=!1}}function re(){k.success(`找到 ${M.value.length} 名骑手`)}function ie(){d.value={searchTerm:"",status:null,page:1,pageSize:20},k.info("搜索条件已重置")}function ue(){H()}const de=[{key:"index",title:"序号",align:"center",width:70,render:(s,a)=>e(S,{value:a+1,type:"warning"},null)},{key:"riderInfo",title:"骑手信息",width:220,render:s=>e("div",{class:"flex items-center gap-12px"},[e(ee,{size:"medium",style:{backgroundColor:s.status===1?"#fa8c16":s.status===0?"#d9d9d9":"#faad14"}},{default:()=>[e(r,null,{default:()=>[e(C,null,null)]})]}),e("div",{class:"flex flex-col"},[e(v,{strong:!0},{default:()=>[s.name||"未设置姓名"]}),e(v,{depth:"3",style:"font-size: 12px;"},{default:()=>[c("ID: "),s.riderId?.slice(-8)||"-"]})])])},{key:"contactInfo",title:"联系方式",align:"center",width:140,render:s=>e("div",{class:"flex items-center justify-center gap-4px"},[e(r,{color:"#1890ff",size:"14"},{default:()=>[e(te,null,null)]}),e(v,{style:"font-size: 12px;"},{default:()=>[s.phoneNumber||"未提供"]})])},{key:"vehicleInfo",title:"车辆信息",align:"center",width:140,render:s=>e("div",{class:"flex items-center justify-center gap-4px"},[e(r,{color:s.vehicleNumber?"#52c41a":"#d9d9d9",size:"14"},{default:()=>[e(se,null,null)]}),e(v,{style:"font-size: 12px;"},{default:()=>[s.vehicleNumber||"未登记"]})])},{key:"status",title:"配送状态",align:"center",width:120,render:s=>{const a={1:{type:"warning",icon:oe,color:"#fa8c16",text:"在线配送"},0:{type:"default",icon:q,color:"#d9d9d9",text:"离线休息"},2:{type:"error",icon:W,color:"#ff4d4f",text:"忙碌配送"}},n=a[s.status]||a[0];return e("div",{class:"flex items-center justify-center gap-4px"},[e(r,{color:n.color,size:"16"},{default:()=>[e(n.icon,null,null)]}),e(S,{value:n.text,type:n.type,style:"--n-color: transparent; --n-text-color: inherit;"},null)])}},{key:"userAccount",title:"关联账户",align:"center",width:140,render:s=>e("div",{class:"flex items-center justify-center gap-4px"},[e(r,{color:"#722ed1",size:"14"},{default:()=>[e(L,null,null)]}),e(v,{style:"font-size: 12px; word-break: break-all;",depth:"3"},{default:()=>[s.applicationUserId?.slice(-8)||"未关联"]})])},{key:"actions",title:"操作",align:"center",width:140,render:s=>e(O,{type:"primary",size:"small",onClick:()=>ce(s.riderId),style:"border-radius: 6px; background: linear-gradient(135deg, #fa8c16, #faad14);"},{default:()=>[e("div",{style:"display: flex; align-items: center; gap: 4px;"},[e(r,{size:"14"},{default:()=>[e(U,null,null)]}),c("查看绩效")])]})}];async function ce(s){try{D.value=!0,T.value=!0,i.value={},z.value={},console.log(`获取骑手详情和绩效排名，ID: ${s}`);const[a,n]=await Promise.allSettled([pe(s),ge(s,$,G)]);a.status==="fulfilled"&&a.value?.data?(i.value=a.value.data,console.log("骑手详情:",i.value)):console.error("获取骑手详情失败:",a),n.status==="fulfilled"&&n.value?.data?(z.value=n.value.data,console.log("骑手绩效排名:",z.value)):console.error("获取骑手绩效排名失败:",n)}catch(a){console.error("获取骑手信息失败:",a),k.error("获取骑手信息失败: "+(a.message||"未知错误")),T.value=!1}finally{D.value=!1}}function Y(s){return{totalOrdersRanking:"总订单排名",onTimeRateRanking:"准时率排名",goodReviewRateRanking:"好评率排名",incomeRanking:"收入排名",TotalOrdersRanking:"总订单排名",OnTimeRateRanking:"准时率排名",GoodReviewRateRanking:"好评率排名",IncomeRanking:"收入排名",IncomeRank:"收入排名",OnTimeRateRank:"准时率排名",GoodReviewRateRank:"好评率排名",TotalOrdersRank:"总订单排名"}[s]||s}function j(s){return s<=3?"success":s<=10?"warning":"info"}return he(()=>{H()}),(s,a)=>(m(),b("div",Te,[o("div",je,[o("h1",Oe,[e(t(r),{size:"24",color:"#fa8c16"},{default:l(()=>[e(t(C))]),_:1}),a[3]||(a[3]=c(" 骑手管理中心 "))]),a[4]||(a[4]=o("p",{class:"text-gray-600"},"管理骑手信息、配送状态和绩效排名",-1))]),e(t(P),{cols:5,"x-gap":16,"y-gap":16,class:"mb-6"},{default:l(()=>[e(t(_),null,{default:l(()=>[e(t(x),{bordered:!1,class:"shadow-sm hover:shadow-lg transition-shadow duration-300"},{default:l(()=>[e(t(I),{label:"总骑手数",value:R.value.total,"value-style":"color: #fa8c16; font-weight: bold;"},{prefix:l(()=>[e(t(r),{size:"20",color:"#fa8c16"},{default:l(()=>[e(t(C))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(t(_),null,{default:l(()=>[e(t(x),{bordered:!1,class:"shadow-sm hover:shadow-lg transition-shadow duration-300"},{default:l(()=>[e(t(I),{label:"在线配送",value:R.value.onlineCount,"value-style":"color: #fa8c16; font-weight: bold;"},{prefix:l(()=>[e(t(r),{size:"20",color:"#fa8c16"},{default:l(()=>[e(t(oe))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(t(_),null,{default:l(()=>[e(t(x),{bordered:!1,class:"shadow-sm hover:shadow-lg transition-shadow duration-300"},{default:l(()=>[e(t(I),{label:"离线休息",value:R.value.offlineCount,"value-style":"color: #d9d9d9; font-weight: bold;"},{prefix:l(()=>[e(t(r),{size:"20",color:"#d9d9d9"},{default:l(()=>[e(t(q))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(t(_),null,{default:l(()=>[e(t(x),{bordered:!1,class:"shadow-sm hover:shadow-lg transition-shadow duration-300"},{default:l(()=>[e(t(I),{label:"忙碌配送",value:R.value.busyCount,"value-style":"color: #ff4d4f; font-weight: bold;"},{prefix:l(()=>[e(t(r),{size:"20",color:"#ff4d4f"},{default:l(()=>[e(t(W))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(t(_),null,{default:l(()=>[e(t(x),{bordered:!1,class:"shadow-sm hover:shadow-lg transition-shadow duration-300"},{default:l(()=>[e(t(I),{label:"在线率",value:R.value.onlineRate,"value-style":"color: #52c41a; font-weight: bold;"},{suffix:l(()=>a[5]||(a[5]=[o("span",{class:"text-sm text-gray-500"},"%",-1)])),prefix:l(()=>[e(t(r),{size:"20",color:"#52c41a"},{default:l(()=>[e(t(B))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),e(t(x),{title:"筛选条件",class:"mb-6 shadow-sm",bordered:!1},{"header-extra":l(()=>[e(t(le),null,{default:l(()=>[e(t(O),{size:"small",onClick:re,type:"primary"},{icon:l(()=>[e(t(r),null,{default:l(()=>[e(t(ze))]),_:1})]),default:l(()=>[a[6]||(a[6]=c(" 搜索 "))]),_:1,__:[6]}),e(t(O),{size:"small",onClick:ie},{icon:l(()=>[e(t(r),null,{default:l(()=>[e(t(Z))]),_:1})]),default:l(()=>[a[7]||(a[7]=c(" 重置 "))]),_:1,__:[7]})]),_:1})]),default:l(()=>[e(t(Re),{model:d.value,inline:"","label-placement":"left","label-width":"80"},{default:l(()=>[e(t(ae),{label:"搜索条件"},{default:l(()=>[e(t(ye),{value:d.value.searchTerm,"onUpdate:value":a[0]||(a[0]=n=>d.value.searchTerm=n),placeholder:"请输入骑手姓名或手机号",clearable:"",style:{width:"250px"}},null,8,["value"])]),_:1}),e(t(ae),{label:"配送状态"},{default:l(()=>[e(t(xe),{value:d.value.status,"onUpdate:value":a[1]||(a[1]=n=>d.value.status=n),options:ne,placeholder:"选择状态",clearable:"",style:{width:"150px"}},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1}),e(t(x),{bordered:!1,class:"shadow-sm"},{header:l(()=>[o("div",Pe,[e(t(r),{size:"18",color:"#fa8c16"},{default:l(()=>[e(t(C))]),_:1}),a[8]||(a[8]=o("span",{class:"font-medium"},"骑手列表",-1))])]),"header-extra":l(()=>[e(t(le),{align:"center"},{default:l(()=>[e(t(v),{depth:"3"},{default:l(()=>[c(" 显示 "+p(M.value.length)+" / "+p(g.value.length)+" 条记录 ",1)]),_:1}),e(t(O),{size:"small",onClick:ue,loading:h.value},{icon:l(()=>[e(t(r),null,{default:l(()=>[e(t(Z))]),_:1})]),default:l(()=>[a[9]||(a[9]=c(" 刷新 "))]),_:1,__:[9]},8,["loading"])]),_:1})]),default:l(()=>[e(t(Ne),{columns:de,data:M.value,loading:h.value,pagination:{pageSize:10,showSizePicker:!0,pageSizes:[10,20,50]},"flex-height":"",class:"min-h-400px","row-class-name":()=>"hover:bg-orange-50 transition-colors duration-200"},null,8,["data","loading"])]),_:1}),e(t(we),{show:T.value,"onUpdate:show":a[2]||(a[2]=n=>T.value=n),preset:"card",style:{width:"900px","max-height":"80vh"},class:"rounded-2xl","mask-closable":!1},{header:l(()=>[o("div",Me,[e(t(ee),{size:40,style:{background:"linear-gradient(135deg, #fa8c16, #faad14)"}},{default:l(()=>[e(t(r),{size:"20"},{default:l(()=>[e(t(C))]),_:1})]),_:1}),o("div",null,[o("h3",De,p(i.value.name||i.value.Name||"骑手绩效信息"),1),o("p",Ae," ID: "+p(i.value.riderId||i.value.RiderId||"-"),1)])])]),default:l(()=>[D.value?(m(),b("div",st,[e(t(Ce),{size:"large"},{description:l(()=>a[19]||(a[19]=[o("div",{class:"text-center mt-4"},[o("p",{class:"text-gray-600"},"正在加载骑手信息..."),o("p",{class:"text-sm text-gray-400 mt-1"},"请稍候片刻")],-1)])),_:1})])):(m(),b("div",Be,[o("div",Ue,[o("h4",Le,[e(t(r),{color:"#fa8c16"},{default:l(()=>[e(t(U))]),_:1}),c(" "+p(t($))+"年"+p(G)+"月绩效概览 ",1)]),Object.keys(z.value).length>0?(m(),A(t(P),{key:0,cols:4,"x-gap":20},{default:l(()=>[(m(!0),b(K,null,Q(z.value,(n,u)=>(m(),A(t(_),{key:u},{default:l(()=>[o("div",Ve,[o("div",{class:be(["text-2xl font-bold",{"text-yellow-600":j(n)==="success","text-orange-600":j(n)==="warning","text-blue-600":j(n)==="info"}])},p(n),3),o("div",Fe,p(Y(u)),1)])]),_:2},1024))),128))]),_:1})):(m(),b("div",Ee,[e(t(r),{size:"48",color:"#d9d9d9"},{default:l(()=>[e(t(B))]),_:1}),a[10]||(a[10]=o("p",{class:"text-gray-500 mt-2"},"暂无当月绩效数据",-1))]))]),e(t(X)),e(t(P),{cols:2,"x-gap":24,"y-gap":20},{default:l(()=>[e(t(_),null,{default:l(()=>[e(t(x),{title:"基本信息",size:"small",class:"h-full"},{"header-extra":l(()=>[e(t(r),{color:"#fa8c16"},{default:l(()=>[e(t(L))]),_:1})]),default:l(()=>[o("div",$e,[o("div",Ge,[a[11]||(a[11]=o("span",{class:"text-gray-600 font-medium"},"骑手ID",-1)),e(t(v),{code:"",style:{"word-break":"break-all","max-width":"200px"}},{default:l(()=>[c(p(i.value.riderId||i.value.RiderId||"-"),1)]),_:1})]),o("div",He,[a[12]||(a[12]=o("span",{class:"text-gray-600 font-medium"},"姓名",-1)),e(t(v),{strong:""},{default:l(()=>[c(p(i.value.name||i.value.Name||"未设置"),1)]),_:1})]),o("div",Ye,[o("span",Je,[e(t(r),{size:"16",color:"#1890ff"},{default:l(()=>[e(t(te))]),_:1}),a[13]||(a[13]=c(" 手机号 "))]),e(t(v),null,{default:l(()=>[c(p(i.value.phoneNumber||i.value.PhoneNumber||"未设置"),1)]),_:1})]),o("div",Ke,[o("span",Qe,[e(t(r),{size:"16",color:"#52c41a"},{default:l(()=>[e(t(se))]),_:1}),a[14]||(a[14]=c(" 车牌号 "))]),e(t(v),null,{default:l(()=>[c(p(i.value.vehicleNumber||i.value.VehicleNumber||"未登记"),1)]),_:1})])])]),_:1})]),_:1}),e(t(_),null,{default:l(()=>[e(t(x),{title:"账户关联",size:"small",class:"h-full"},{"header-extra":l(()=>[e(t(r),{color:"#722ed1"},{default:l(()=>[e(t(L))]),_:1})]),default:l(()=>[o("div",Xe,[o("div",qe,[a[15]||(a[15]=o("span",{class:"text-gray-600 font-medium"},"关联用户ID",-1)),e(t(v),{style:{"word-break":"break-all","max-width":"200px"}},{default:l(()=>[c(p(i.value.applicationUserId||i.value.ApplicationUserId||"未关联"),1)]),_:1})]),o("div",We,[a[16]||(a[16]=o("span",{class:"text-gray-600 font-medium"},"账户状态",-1)),e(t(S),{value:i.value.applicationUserId?"已关联":"未关联",type:i.value.applicationUserId?"success":"warning"},null,8,["value","type"])]),o("div",Ze,[a[17]||(a[17]=o("span",{class:"text-gray-600 font-medium"},"车辆状态",-1)),e(t(S),{value:i.value.vehicleNumber?"已登记":"未登记",type:i.value.vehicleNumber?"success":"warning"},null,8,["value","type"])])])]),_:1})]),_:1})]),_:1}),Object.keys(z.value).length>0?(m(),b("div",et,[e(t(X),null,{default:l(()=>[e(t(r),{color:"#fa8c16"},{default:l(()=>[e(t(U))]),_:1}),a[18]||(a[18]=c(" 详细排名 "))]),_:1,__:[18]}),e(t(P),{cols:2,"x-gap":16,"y-gap":12},{default:l(()=>[(m(!0),b(K,null,Q(z.value,(n,u)=>(m(),A(t(_),{key:u},{default:l(()=>[o("div",tt,[o("div",at,[e(t(r),{color:"#fa8c16",size:"16"},{default:l(()=>[e(t(B))]),_:1}),o("span",lt,p(Y(u)),1)]),e(t(S),{value:`第${n}名`,type:j(n),style:{"--n-font-size":"12px"}},null,8,["value","type"])])]),_:2},1024))),128))]),_:1})])):_e("",!0)]))]),_:1},8,["show"])]))}}),_t=ke(ot,[["__scopeId","data-v-8406aaca"]]);export{_t as default};
//# sourceMappingURL=index-DkInX1rr.js.map
