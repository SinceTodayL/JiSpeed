import{f as de,b as ue,c as ce}from"./rider-BKyQSFTf.js";import{B as I}from"./BicycleOutline-BL0mGmEY.js";import{S as B}from"./StatsChartOutline-__l0UHXs.js";import{d as ae,b,o as v,aA as fe,O as pe,r as x,a as J,P as me,aB as U,e as o,f as e,g as f,w as a,h as t,Q as n,J as y,N as ge,B as j,t as p,E as ve,c as V,F as K,v as Q,ae as he,s as X,U as ye,X as _e}from"./index-w5jcwJ4S.js";import{N as T,S as xe,R as q,a as be,b as g,c as W}from"./SearchOutline-DKn4_LQz.js";import{T as L}from"./TrophyOutline-CYxDP4JD.js";import{C as Z}from"./CallOutline-6uOGpJCH.js";import{P as F}from"./PersonOutline-CLNiZjLr.js";import{N as _,a as P}from"./Grid-BxpIc_A9.js";import{b as we,N as ke,a as ee}from"./FormItem-CFM-Y1F5.js";import{_ as D}from"./Badge-BI2LwFAf.js";import{N as ze}from"./Spin-DyCks1FC.js";const Ne={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},te=ae({name:"CarOutline",render:function(w,k){return v(),b("svg",Ne,k[0]||(k[0]=[fe('<path d="M80 224l37.78-88.15C123.93 121.5 139.6 112 157.11 112h197.78c17.51 0 33.18 9.5 39.33 23.85L432 224" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M80 224h352v144H80z"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M112 368v32H80v-32"></path><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32" d="M432 368v32h-32v-32"></path><circle cx="144" cy="288" r="16" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></circle><circle cx="368" cy="288" r="16" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="32"></circle>',6)]))}}),Re={class:"p-6 min-h-full bg-gradient-to-br from-orange-50 to-yellow-50"},Ce={class:"mb-6"},Ie={class:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-2"},Te={class:"flex items-center gap-2"},Se={class:"flex items-center gap-3"},Oe={class:"text-lg font-semibold text-gray-800"},je={class:"text-sm text-gray-500"},Pe={key:0,class:"space-y-6"},De={class:"bg-gradient-to-r from-orange-50 to-yellow-50 p-4 rounded-lg"},Me={class:"text-gray-800 font-medium mb-4 flex items-center gap-2"},Ae={class:"text-center"},Be={class:"text-sm text-gray-600"},Ue={key:1,class:"text-center py-8"},Ve={class:"space-y-4"},Le={class:"flex justify-between items-center py-2 border-b border-gray-100"},Fe={class:"flex justify-between items-center py-2 border-b border-gray-100"},Ee={class:"flex justify-between items-center py-2 border-b border-gray-100"},Ge={class:"text-gray-600 font-medium flex items-center gap-2"},$e={class:"flex justify-between items-center py-2"},He={class:"text-gray-600 font-medium flex items-center gap-2"},Ye={class:"space-y-4"},Je={class:"flex justify-between items-start py-2 border-b border-gray-100"},Ke={class:"flex justify-between items-center py-2 border-b border-gray-100"},Qe={class:"flex justify-between items-center py-2"},Xe={key:0},qe={class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},We={class:"flex items-center gap-2"},Ze={class:"text-gray-700 font-medium"},et={key:1,class:"flex justify-center items-center h-80"},tt=ae({name:"rider-manage",__name:"index",setup(le){const w=pe(),k=x(!1),m=x([]),N=x({page:1,pageSize:20,totalCount:0,totalPages:0}),h=x({searchTerm:"",page:1,pageSize:20}),R=J(()=>{const s=m.value.length,l=m.value.filter(i=>i.status===1).length,d=m.value.filter(i=>i.status===0).length,u=m.value.filter(i=>i.status===2).length,c=m.value.filter(i=>i.vehicleNumber).length;return{total:s,onlineCount:l,offlineCount:d,busyCount:u,withVehicle:c,onlineRate:s>0?Math.round(l/s*100):0,vehicleRate:s>0?Math.round(c/s*100):0}}),M=J(()=>m.value.filter(s=>{if(h.value.searchTerm){const l=h.value.searchTerm.toLowerCase();if(!s.name?.toLowerCase().includes(l)&&!s.phoneNumber?.toLowerCase().includes(l))return!1}return!0})),S=x(!1),A=x(!1),r=x({}),z=x({}),E=new Date,G=E.getFullYear(),$=E.getMonth()+1;async function H(){try{k.value=!0;const s={page:h.value.page,pageSize:h.value.pageSize};h.value.searchTerm&&(s.searchTerm=h.value.searchTerm),console.log("🚀 开始请求骑手列表，参数:",s);const l=await de(s);if(console.log("📥 收到骑手列表响应:",l),l&&l.data){console.log("详细的响应数据结构:",l.data);let d=null,u=null;l.data.Riders&&Array.isArray(l.data.Riders)?(d=l.data.Riders,u=l.data.Pagination):l.data.riders&&Array.isArray(l.data.riders)?(d=l.data.riders,u=l.data.pagination):Array.isArray(l.data)&&(d=l.data,u=null),console.log("解析出的骑手数据:",d),console.log("解析出的分页信息:",u),d&&Array.isArray(d)?(m.value=d.map((c,i)=>({...c,index:(N.value.page-1)*N.value.pageSize+i+1,riderId:c.riderId||c.RiderId||"-",name:c.name||c.Name||"-",phoneNumber:c.phoneNumber||c.PhoneNumber||"-",vehicleNumber:c.vehicleNumber||c.VehicleNumber||"-",applicationUserId:c.applicationUserId||c.ApplicationUserId||"-"})),console.log("处理后的表格数据:",m.value),u?N.value={page:u.page||u.Page||1,pageSize:u.pageSize||u.PageSize||20,totalCount:u.totalCount||u.TotalCount||0,totalPages:u.totalPages||u.TotalPages||0}:(N.value.totalCount=d.length,N.value.totalPages=Math.ceil(d.length/N.value.pageSize))):(console.log("没有找到有效的骑手数据数组"),m.value=[])}else w.error(l?.message||"获取骑手列表失败"),m.value=[]}catch(s){w.error("获取骑手列表失败: "+s.message),m.value=[],console.error("Error fetching riders list:",s)}finally{k.value=!1}}function se(){w.success(`找到 ${M.value.length} 名骑手`)}function oe(){h.value={searchTerm:"",status:null,page:1,pageSize:20},w.info("搜索条件已重置")}function ne(){w.info("正在刷新骑手数据..."),H()}const re=[{key:"index",title:"序号",align:"center",width:70,render:(s,l)=>e(D,{value:l+1,type:"warning"},null)},{key:"riderInfo",title:"骑手信息",width:220,render:s=>e("div",{class:"flex items-center gap-12px"},[e(W,{size:"medium",style:{backgroundColor:s.status===1?"#fa8c16":s.status===0?"#d9d9d9":"#faad14"}},{default:()=>[e(n,null,{default:()=>[e(I,null,null)]})]}),e("div",{class:"flex flex-col"},[e(g,{strong:!0},{default:()=>[s.name||"未设置姓名"]}),e(g,{depth:"3",style:"font-size: 12px;"},{default:()=>[f("ID: "),s.riderId?.slice(-8)||"-"]})])])},{key:"contactInfo",title:"联系方式",align:"center",width:140,render:s=>e("div",{class:"flex items-center justify-center gap-4px"},[e(n,{color:"#1890ff",size:"14"},{default:()=>[e(Z,null,null)]}),e(g,{style:"font-size: 12px;"},{default:()=>[s.phoneNumber||"未提供"]})])},{key:"vehicleInfo",title:"车辆信息",align:"center",width:140,render:s=>e("div",{class:"flex items-center justify-center gap-4px"},[e(n,{color:s.vehicleNumber?"#52c41a":"#d9d9d9",size:"14"},{default:()=>[e(te,null,null)]}),e(g,{style:"font-size: 12px;"},{default:()=>[s.vehicleNumber||"未登记"]})])},{key:"userAccount",title:"关联账户",align:"center",width:140,render:s=>e("div",{class:"flex items-center justify-center gap-4px"},[e(n,{color:"#722ed1",size:"14"},{default:()=>[e(F,null,null)]}),e(g,{style:"font-size: 12px; word-break: break-all;",depth:"3"},{default:()=>[s.applicationUserId?.slice(-8)||"未关联"]})])},{key:"actions",title:"操作",align:"center",width:140,render:s=>e(j,{type:"primary",size:"small",onClick:()=>ie(s.riderId),style:"border-radius: 6px; background: linear-gradient(135deg, #fa8c16, #faad14);"},{default:()=>[e("div",{style:"display: flex; align-items: center; gap: 4px;"},[e(n,{size:"14"},{default:()=>[e(L,null,null)]}),f("查看绩效")])]})}];async function ie(s){try{A.value=!0,S.value=!0,r.value={},z.value={},console.log(`获取骑手详情和绩效排名，ID: ${s}`);const[l,d]=await Promise.allSettled([ue(s),ce(s,G,$)]);l.status==="fulfilled"&&l.value?.data?(r.value=l.value.data,console.log("骑手详情:",r.value)):console.error("获取骑手详情失败:",l),d.status==="fulfilled"&&d.value?.data?(z.value=d.value.data,console.log("骑手绩效排名:",z.value)):console.error("获取骑手绩效排名失败:",d)}catch(l){console.error("获取骑手信息失败:",l),w.error("获取骑手信息失败: "+(l.message||"未知错误")),S.value=!1}finally{A.value=!1}}function Y(s){return{totalOrdersRanking:"总订单排名",onTimeRateRanking:"准时率排名",goodReviewRateRanking:"好评率排名",incomeRanking:"收入排名",TotalOrdersRanking:"总订单排名",OnTimeRateRanking:"准时率排名",GoodReviewRateRanking:"好评率排名",IncomeRanking:"收入排名",IncomeRank:"收入排名",OnTimeRateRank:"准时率排名",GoodReviewRateRank:"好评率排名",TotalOrdersRank:"总订单排名"}[s]||s}function O(s){return s<=3?"success":s<=10?"warning":"info"}return me(()=>{H()}),(s,l)=>{const d=U("FlashOutline"),u=U("PauseCircleOutline"),c=U("TimeOutline");return v(),b("div",Re,[o("div",Ce,[o("h1",Ie,[e(t(n),{size:"24",color:"#fa8c16"},{default:a(()=>[e(t(I))]),_:1}),l[2]||(l[2]=f(" 骑手管理中心 "))]),l[3]||(l[3]=o("p",{class:"text-gray-600"},"管理骑手信息和绩效排名",-1))]),e(t(P),{cols:5,"x-gap":16,"y-gap":16,class:"mb-6"},{default:a(()=>[e(t(_),null,{default:a(()=>[e(t(y),{bordered:!1,class:"shadow-sm hover:shadow-lg transition-shadow duration-300"},{default:a(()=>[e(t(T),{label:"总骑手数",value:R.value.total,"value-style":"color: #fa8c16; font-weight: bold;"},{prefix:a(()=>[e(t(n),{size:"20",color:"#fa8c16"},{default:a(()=>[e(t(I))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(t(_),null,{default:a(()=>[e(t(y),{bordered:!1,class:"shadow-sm hover:shadow-lg transition-shadow duration-300"},{default:a(()=>[e(t(T),{label:"在线配送",value:R.value.onlineCount,"value-style":"color: #fa8c16; font-weight: bold;"},{prefix:a(()=>[e(t(n),{size:"20",color:"#fa8c16"},{default:a(()=>[e(d)]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(t(_),null,{default:a(()=>[e(t(y),{bordered:!1,class:"shadow-sm hover:shadow-lg transition-shadow duration-300"},{default:a(()=>[e(t(T),{label:"离线休息",value:R.value.offlineCount,"value-style":"color: #d9d9d9; font-weight: bold;"},{prefix:a(()=>[e(t(n),{size:"20",color:"#d9d9d9"},{default:a(()=>[e(u)]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(t(_),null,{default:a(()=>[e(t(y),{bordered:!1,class:"shadow-sm hover:shadow-lg transition-shadow duration-300"},{default:a(()=>[e(t(T),{label:"忙碌配送",value:R.value.busyCount,"value-style":"color: #ff4d4f; font-weight: bold;"},{prefix:a(()=>[e(t(n),{size:"20",color:"#ff4d4f"},{default:a(()=>[e(c)]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(t(_),null,{default:a(()=>[e(t(y),{bordered:!1,class:"shadow-sm hover:shadow-lg transition-shadow duration-300"},{default:a(()=>[e(t(T),{label:"在线率",value:R.value.onlineRate,"value-style":"color: #52c41a; font-weight: bold;"},{suffix:a(()=>l[4]||(l[4]=[o("span",{class:"text-sm text-gray-500"},"%",-1)])),prefix:a(()=>[e(t(n),{size:"20",color:"#52c41a"},{default:a(()=>[e(t(B))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),e(t(y),{title:"筛选条件",class:"mb-6 shadow-sm",bordered:!1},{"header-extra":a(()=>[e(t(ee),null,{default:a(()=>[e(t(j),{size:"small",onClick:se,type:"primary"},{icon:a(()=>[e(t(n),null,{default:a(()=>[e(t(xe))]),_:1})]),default:a(()=>[l[5]||(l[5]=f(" 搜索 "))]),_:1,__:[5]}),e(t(j),{size:"small",onClick:oe},{icon:a(()=>[e(t(n),null,{default:a(()=>[e(t(q))]),_:1})]),default:a(()=>[l[6]||(l[6]=f(" 重置 "))]),_:1,__:[6]})]),_:1})]),default:a(()=>[e(t(we),{model:h.value,inline:"","label-placement":"left","label-width":"80"},{default:a(()=>[e(t(ke),{label:"搜索条件"},{default:a(()=>[e(t(ge),{value:h.value.searchTerm,"onUpdate:value":l[0]||(l[0]=i=>h.value.searchTerm=i),placeholder:"请输入骑手姓名或手机号",clearable:"",style:{width:"250px"}},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1}),e(t(y),{bordered:!1,class:"shadow-sm"},{header:a(()=>[o("div",Te,[e(t(n),{size:"18",color:"#fa8c16"},{default:a(()=>[e(t(I))]),_:1}),l[7]||(l[7]=o("span",{class:"font-medium"},"骑手列表",-1))])]),"header-extra":a(()=>[e(t(ee),{align:"center"},{default:a(()=>[e(t(g),{depth:"3"},{default:a(()=>[f(" 显示 "+p(M.value.length)+" / "+p(m.value.length)+" 条记录 ",1)]),_:1}),e(t(j),{size:"small",onClick:ne,loading:k.value},{icon:a(()=>[e(t(n),null,{default:a(()=>[e(t(q))]),_:1})]),default:a(()=>[l[8]||(l[8]=f(" 刷新 "))]),_:1,__:[8]},8,["loading"])]),_:1})]),default:a(()=>[e(t(be),{columns:re,data:M.value,loading:k.value,pagination:{pageSize:10,showSizePicker:!0,pageSizes:[10,20,50]},"flex-height":"",class:"min-h-400px","row-class-name":()=>"hover:bg-orange-50 transition-colors duration-200"},null,8,["data","loading"])]),_:1}),e(t(ye),{show:S.value,"onUpdate:show":l[1]||(l[1]=i=>S.value=i),preset:"card",style:{width:"900px","max-height":"80vh"},class:"rounded-2xl","mask-closable":!1},{header:a(()=>[o("div",Se,[e(t(W),{size:40,style:{background:"linear-gradient(135deg, #fa8c16, #faad14)"}},{default:a(()=>[e(t(n),{size:"20"},{default:a(()=>[e(t(I))]),_:1})]),_:1}),o("div",null,[o("h3",Oe,p(r.value.name||r.value.Name||"骑手绩效信息"),1),o("p",je," ID: "+p(r.value.riderId||r.value.RiderId||"-"),1)])])]),default:a(()=>[A.value?(v(),b("div",et,[e(t(ze),{size:"large"},{description:a(()=>l[18]||(l[18]=[o("div",{class:"text-center mt-4"},[o("p",{class:"text-gray-600"},"正在加载骑手信息..."),o("p",{class:"text-sm text-gray-400 mt-1"},"请稍候片刻")],-1)])),_:1})])):(v(),b("div",Pe,[o("div",De,[o("h4",Me,[e(t(n),{color:"#fa8c16"},{default:a(()=>[e(t(L))]),_:1}),f(" "+p(t(G))+"年"+p($)+"月绩效概览 ",1)]),Object.keys(z.value).length>0?(v(),V(t(P),{key:0,cols:4,"x-gap":20},{default:a(()=>[(v(!0),b(K,null,Q(z.value,(i,C)=>(v(),V(t(_),{key:C},{default:a(()=>[o("div",Ae,[o("div",{class:he(["text-2xl font-bold",{"text-yellow-600":O(i)==="success","text-orange-600":O(i)==="warning","text-blue-600":O(i)==="info"}])},p(i),3),o("div",Be,p(Y(C)),1)])]),_:2},1024))),128))]),_:1})):(v(),b("div",Ue,[e(t(n),{size:"48",color:"#d9d9d9"},{default:a(()=>[e(t(B))]),_:1}),l[9]||(l[9]=o("p",{class:"text-gray-500 mt-2"},"暂无当月绩效数据",-1))]))]),e(t(X)),e(t(P),{cols:2,"x-gap":24,"y-gap":20},{default:a(()=>[e(t(_),null,{default:a(()=>[e(t(y),{title:"基本信息",size:"small",class:"h-full"},{"header-extra":a(()=>[e(t(n),{color:"#fa8c16"},{default:a(()=>[e(t(F))]),_:1})]),default:a(()=>[o("div",Ve,[o("div",Le,[l[10]||(l[10]=o("span",{class:"text-gray-600 font-medium"},"骑手ID",-1)),e(t(g),{code:"",style:{"word-break":"break-all","max-width":"200px"}},{default:a(()=>[f(p(r.value.riderId||r.value.RiderId||"-"),1)]),_:1})]),o("div",Fe,[l[11]||(l[11]=o("span",{class:"text-gray-600 font-medium"},"姓名",-1)),e(t(g),{strong:""},{default:a(()=>[f(p(r.value.name||r.value.Name||"未设置"),1)]),_:1})]),o("div",Ee,[o("span",Ge,[e(t(n),{size:"16",color:"#1890ff"},{default:a(()=>[e(t(Z))]),_:1}),l[12]||(l[12]=f(" 手机号 "))]),e(t(g),null,{default:a(()=>[f(p(r.value.phoneNumber||r.value.PhoneNumber||"未设置"),1)]),_:1})]),o("div",$e,[o("span",He,[e(t(n),{size:"16",color:"#52c41a"},{default:a(()=>[e(t(te))]),_:1}),l[13]||(l[13]=f(" 车牌号 "))]),e(t(g),null,{default:a(()=>[f(p(r.value.vehicleNumber||r.value.VehicleNumber||"未登记"),1)]),_:1})])])]),_:1})]),_:1}),e(t(_),null,{default:a(()=>[e(t(y),{title:"账户关联",size:"small",class:"h-full"},{"header-extra":a(()=>[e(t(n),{color:"#722ed1"},{default:a(()=>[e(t(F))]),_:1})]),default:a(()=>[o("div",Ye,[o("div",Je,[l[14]||(l[14]=o("span",{class:"text-gray-600 font-medium"},"关联用户ID",-1)),e(t(g),{style:{"word-break":"break-all","max-width":"200px"}},{default:a(()=>[f(p(r.value.applicationUserId||r.value.ApplicationUserId||"未关联"),1)]),_:1})]),o("div",Ke,[l[15]||(l[15]=o("span",{class:"text-gray-600 font-medium"},"账户状态",-1)),e(t(D),{value:r.value.applicationUserId?"已关联":"未关联",type:r.value.applicationUserId?"success":"warning"},null,8,["value","type"])]),o("div",Qe,[l[16]||(l[16]=o("span",{class:"text-gray-600 font-medium"},"车辆状态",-1)),e(t(D),{value:r.value.vehicleNumber?"已登记":"未登记",type:r.value.vehicleNumber?"success":"warning"},null,8,["value","type"])])])]),_:1})]),_:1})]),_:1}),Object.keys(z.value).length>0?(v(),b("div",Xe,[e(t(X),null,{default:a(()=>[e(t(n),{color:"#fa8c16"},{default:a(()=>[e(t(L))]),_:1}),l[17]||(l[17]=f(" 详细排名 "))]),_:1,__:[17]}),e(t(P),{cols:2,"x-gap":16,"y-gap":12},{default:a(()=>[(v(!0),b(K,null,Q(z.value,(i,C)=>(v(),V(t(_),{key:C},{default:a(()=>[o("div",qe,[o("div",We,[e(t(n),{color:"#fa8c16",size:"16"},{default:a(()=>[e(t(B))]),_:1}),o("span",Ze,p(Y(C)),1)]),e(t(D),{value:`第${i}名`,type:O(i),style:{"--n-font-size":"12px"}},null,8,["value","type"])])]),_:2},1024))),128))]),_:1})])):ve("",!0)]))]),_:1},8,["show"])])}}}),mt=_e(tt,[["__scopeId","data-v-0e90477d"]]);export{mt as default};
//# sourceMappingURL=index-IJy2Q3Fj.js.map
