import{L as q,d as A,b as C,o as k,e as s,O as ne,r as w,a as R,P as oe,f as e,g as u,w as a,h as t,R as d,J as _,N as re,S as T,B as P,t as f,s as ie,W as b,c as ue,E as de,K as fe,V as ce,Y as me}from"./index-BAs_WLux.js";import{N as D,S as ve,R as F,a as pe,b as m,c as G}from"./SearchOutline-JbPAbITz.js";import{T as j}from"./TrophyOutline-DMFyA1XZ.js";import{P as M}from"./PersonOutline-B68i6cpn.js";import{C as H}from"./CallOutline-BD7o8TPg.js";import{S as ge}from"./StatsChartOutline-C1kl2uiW.js";import{E as xe}from"./EyeOutline-B7PTlgYu.js";import{N as h,a as B}from"./Grid-BbkZfnsV.js";import{b as he,N,a as J}from"./FormItem-DaUQ-IrC.js";import{N as ye}from"./Spin-DEAmSezr.js";import{_ as be}from"./Badge-D3shIcCP.js";function K(v){switch(v){case 1:return"男";case 2:return"女";case 3:return"未知";default:return"未知"}}function W(v){return`LV${v}`}function Y(v){return q(`/api/users/${v}`)}function _e(v={}){return q("/api/users",v)}const we={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},U=A({name:"MailOutline",render:function(g,p){return k(),C("svg",we,p[0]||(p[0]=[s("rect",{x:"48",y:"96",width:"416",height:"320",rx:"40",ry:"40",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),s("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32",d:"M112 160l144 112l144-112"},null,-1)]))}}),ke={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},L=A({name:"PeopleOutline",render:function(g,p){return k(),C("svg",ke,p[0]||(p[0]=[s("path",{d:"M402 168c-2.93 40.67-33.1 72-66 72s-63.12-31.32-66-72c-3-42.31 26.37-72 66-72s69 30.46 66 72z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),s("path",{d:"M336 304c-65.17 0-127.84 32.37-143.54 95.41c-2.08 8.34 3.15 16.59 11.72 16.59h263.65c8.57 0 13.77-8.25 11.72-16.59C463.85 335.36 401.18 304 336 304z",fill:"none",stroke:"currentColor","stroke-miterlimit":"10","stroke-width":"32"},null,-1),s("path",{d:"M200 185.94c-2.34 32.48-26.72 58.06-53 58.06s-50.7-25.57-53-58.06C91.61 152.15 115.34 128 147 128s55.39 24.77 53 57.94z",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"32"},null,-1),s("path",{d:"M206 306c-18.05-8.27-37.93-11.45-59-11.45c-52 0-102.1 25.85-114.65 76.2c-1.65 6.66 2.53 13.25 9.37 13.25H154",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-miterlimit":"10","stroke-width":"32"},null,-1)]))}}),ze={class:"p-6 min-h-full bg-gray-50"},Ne={class:"mb-6"},Ce={class:"text-2xl font-bold text-gray-800 mb-2 flex items-center gap-2"},Te={class:"flex items-center gap-2"},Pe={class:"flex items-center gap-3"},je={class:"text-lg font-semibold text-gray-800"},Ee={class:"text-sm text-gray-500"},Oe={key:0,class:"space-y-6"},Se={class:"bg-gradient-to-r from-blue-50 to-indigo-50 p-4 rounded-lg"},Ie={class:"text-center"},De={class:"text-2xl font-bold text-blue-600"},Me={class:"text-center"},Be={class:"text-2xl font-bold text-purple-600"},Ue={class:"text-center"},Le={class:"text-2xl font-bold text-green-600"},Ae={class:"text-center"},Ve={class:"text-2xl font-bold text-orange-600"},$e={class:"space-y-4"},Re={class:"flex justify-between items-center py-2 border-b border-gray-100"},Fe={class:"flex justify-between items-center py-2 border-b border-gray-100"},Ge={class:"flex justify-between items-center py-2 border-b border-gray-100"},He={class:"flex justify-between items-center py-2 border-b border-gray-100"},Je={class:"flex justify-between items-center py-2"},Ke={class:"space-y-4"},We={class:"flex justify-between items-center py-2 border-b border-gray-100"},Ye={class:"text-gray-600 font-medium flex items-center gap-2"},qe={class:"flex justify-between items-center py-2 border-b border-gray-100"},Qe={class:"text-gray-600 font-medium flex items-center gap-2"},Xe={class:"flex justify-between items-center py-2 border-b border-gray-100"},Ze={class:"flex justify-between items-center py-2 border-b border-gray-100"},el={class:"flex justify-between items-center py-2"},ll={key:1,class:"flex justify-center items-center h-80"},tl=A({name:"user-manage",__name:"index",setup(v){const g=ne(),p=w(!1),x=w([]),z=w(!1),E=w(!1),o=w({}),r=w({nickname:"",gender:null,level:null,hasEmail:null,hasPhone:null}),O=R(()=>{const n=x.value.length,l=x.value.filter(y=>y.gender===1).length,i=x.value.filter(y=>y.gender===2).length,I=x.value.filter(y=>y.phoneNumber).length;return{total:n,maleCount:l,femaleCount:i,withPhone:I,phoneRate:n>0?Math.round(I/n*100):0}}),Q=[{label:"全部性别",value:null},{label:"男",value:1},{label:"女",value:2},{label:"未知",value:0}],X=[{label:"全部等级",value:null},{label:"普通用户",value:1},{label:"VIP用户",value:2},{label:"黄金用户",value:3}],V=[{label:"全部",value:null},{label:"已绑定",value:!0},{label:"未绑定",value:!1}],S=R(()=>x.value.filter(n=>!(r.value.nickname&&!n.nickname?.toLowerCase().includes(r.value.nickname.toLowerCase())||r.value.gender!==null&&n.gender!==r.value.gender||r.value.level!==null&&n.level!==r.value.level||r.value.hasEmail!==null&&!!n.email!==r.value.hasEmail||r.value.hasPhone!==null&&!!n.phoneNumber!==r.value.hasPhone)));function Z(){g.success(`找到 ${S.value.length} 个用户`)}function ee(){r.value={nickname:"",gender:null,level:null,hasEmail:null,hasPhone:null},g.info("搜索条件已重置")}function le(){$()}async function $(){try{p.value=!0;const n=await _e();if(n&&Array.isArray(n.data)){const i=n.data.map(c=>c.userId).map(c=>Y(c)),y=(await Promise.allSettled(i)).filter(c=>c.status==="fulfilled"&&c.value.data).map(c=>c.value.data);x.value=y.map((c,se)=>({...c,index:se+1,genderText:K(c.gender),levelText:W(c.level),totalOrdersText:c.stats?.totalOrders||0,favoriteCountText:c.stats?.favoriteCount||0,hasEmail:c.email?"是":"否",hasPhone:c.phoneNumber?"是":"否"})),g.success(`成功加载 ${y.length} 个用户的详细数据`)}else g.error(n.message||"获取用户列表失败"),x.value=[]}catch(n){g.error("获取用户列表失败: "+n.message),x.value=[],console.error("Error fetching user list:",n)}finally{p.value=!1}}const te=[{key:"index",title:"序号",align:"center",width:70,render:(n,l)=>e(be,{value:l+1,type:"info"},null)},{key:"userInfo",title:"用户信息",width:200,render:n=>e("div",{class:"flex items-center gap-12px"},[e(G,{size:"medium",style:{backgroundColor:n.gender===1?"#409eff":n.gender===2?"#f56c6c":"#909399"}},{default:()=>[e(d,null,{default:()=>[e(M,null,null)]})]}),e("div",{class:"flex flex-col"},[e(m,{strong:!0},{default:()=>[n.nickname||"未设置昵称"]}),e(m,{depth:"3",style:"font-size: 12px;"},{default:()=>[u("ID: "),n.userId?.slice(-8)||"-"]})])])},{key:"genderText",title:"性别",align:"center",width:80,render:n=>{const l={1:{type:"info",color:"#409eff"},2:{type:"error",color:"#f56c6c"},0:{type:"default",color:"#909399"}},i=l[n.gender]||l[0];return e(b,{type:i.type,size:"small"},{default:()=>[n.genderText]})}},{key:"levelText",title:"用户等级",align:"center",width:120,render:n=>{const l={1:{type:"default",icon:null},2:{type:"warning",icon:j},3:{type:"success",icon:j}},i=l[n.level]||l[1];return e(b,{type:i.type,size:"small"},{default:()=>[i.icon&&e(d,{component:i.icon,style:"margin-right: 4px;"},null),n.levelText]})}},{key:"stats",title:"用户统计",align:"center",width:120,render:n=>e("div",{class:"flex flex-col gap-4px"},[e("div",{class:"flex items-center justify-center gap-4px"},[e(d,{color:"#409eff",size:"14"},{default:()=>[e(ge,null,null)]}),e(m,{style:"font-size: 12px;"},{default:()=>[u("订单: "),n.totalOrdersText]})]),e("div",{class:"flex items-center justify-center gap-4px"},[e(d,{color:"#f56c6c",size:"14"},{default:()=>[e(j,null,null)]}),e(m,{style:"font-size: 12px;"},{default:()=>[u("收藏: "),n.favoriteCountText]})])])},{key:"contact",title:"联系方式",align:"center",width:120,render:n=>e("div",{class:"flex flex-col gap-4px"},[e("div",{class:"flex items-center justify-center gap-4px"},[e(d,{color:n.email?"#67c23a":"#dcdfe6",size:"14"},{default:()=>[e(U,null,null)]}),e(b,{size:"small",type:n.email?"success":"default"},{default:()=>[n.hasEmail]})]),e("div",{class:"flex items-center justify-center gap-4px"},[e(d,{color:n.phoneNumber?"#67c23a":"#dcdfe6",size:"14"},{default:()=>[e(H,null,null)]}),e(b,{size:"small",type:n.phoneNumber?"success":"default"},{default:()=>[n.hasPhone]})])])},{key:"actions",title:"操作",align:"center",width:120,render:n=>e(P,{type:"primary",size:"small",onClick:()=>ae(n.userId),style:"border-radius: 6px;"},{default:()=>[e("div",{style:"display: flex; align-items: center; gap: 4px;"},[e(d,{size:"14"},{default:()=>[e(xe,null,null)]}),u("查看详情")])]})}];async function ae(n){try{E.value=!0,z.value=!0,o.value={},console.log(`获取用户详情，ID: ${n}`);const l=await Y(n);l&&l.data?(o.value={...l.data,genderText:K(l.data.gender),levelText:W(l.data.level),hasEmail:l.data.email?"是":"否",hasPhone:l.data.phoneNumber?"是":"否"},console.log("用户详情:",o.value)):(g.error(l?.message||"获取用户详情失败"),z.value=!1)}catch(l){console.error("获取用户详情失败:",l),g.error("获取用户详情失败: "+(l.message||"未知错误")),z.value=!1}finally{E.value=!1}}return oe(()=>{$()}),(n,l)=>(k(),C("div",ze,[s("div",Ne,[s("h1",Ce,[e(t(d),{size:"24",color:"#409eff"},{default:a(()=>[e(t(L))]),_:1}),l[6]||(l[6]=u(" 用户管理中心 "))]),l[7]||(l[7]=s("p",{class:"text-gray-600"},"管理和查看所有用户信息",-1))]),e(t(B),{cols:3,"x-gap":16,"y-gap":16,class:"mb-6"},{default:a(()=>[e(t(h),null,{default:a(()=>[e(t(_),{bordered:!1,class:"shadow-sm hover:shadow-lg transition-shadow duration-300"},{default:a(()=>[e(t(D),{label:"总用户数",value:O.value.total,"value-style":"color: #409eff; font-weight: bold;"},{prefix:a(()=>[e(t(d),{size:"20",color:"#409eff"},{default:a(()=>[e(t(L))]),_:1})]),_:1},8,["value"])]),_:1})]),_:1}),e(t(h),null,{default:a(()=>[e(t(_),{bordered:!1,class:"shadow-sm hover:shadow-lg transition-shadow duration-300"},{default:a(()=>[e(t(D),{label:"男性用户",value:O.value.maleCount,"value-style":"color: #409eff; font-weight: bold;"},{suffix:a(()=>l[8]||(l[8]=[s("span",{class:"text-sm text-gray-500"},"人",-1)])),_:1},8,["value"])]),_:1})]),_:1}),e(t(h),null,{default:a(()=>[e(t(_),{bordered:!1,class:"shadow-sm hover:shadow-lg transition-shadow duration-300"},{default:a(()=>[e(t(D),{label:"女性用户",value:O.value.femaleCount,"value-style":"color: #f56c6c; font-weight: bold;"},{suffix:a(()=>l[9]||(l[9]=[s("span",{class:"text-sm text-gray-500"},"人",-1)])),_:1},8,["value"])]),_:1})]),_:1})]),_:1}),e(t(_),{title:"筛选条件",class:"mb-6 shadow-sm",bordered:!1},{"header-extra":a(()=>[e(t(J),null,{default:a(()=>[e(t(P),{size:"small",onClick:Z,type:"primary"},{icon:a(()=>[e(t(d),null,{default:a(()=>[e(t(ve))]),_:1})]),default:a(()=>[l[10]||(l[10]=u(" 搜索 "))]),_:1,__:[10]}),e(t(P),{size:"small",onClick:ee},{icon:a(()=>[e(t(d),null,{default:a(()=>[e(t(F))]),_:1})]),default:a(()=>[l[11]||(l[11]=u(" 重置 "))]),_:1,__:[11]})]),_:1})]),default:a(()=>[e(t(he),{model:r.value,inline:"","label-placement":"left","label-width":"80"},{default:a(()=>[e(t(N),{label:"用户昵称"},{default:a(()=>[e(t(re),{value:r.value.nickname,"onUpdate:value":l[0]||(l[0]=i=>r.value.nickname=i),placeholder:"请输入用户昵称",clearable:"",style:{width:"180px"}},null,8,["value"])]),_:1}),e(t(N),{label:"性别"},{default:a(()=>[e(t(T),{value:r.value.gender,"onUpdate:value":l[1]||(l[1]=i=>r.value.gender=i),options:Q,placeholder:"选择性别",clearable:"",style:{width:"120px"}},null,8,["value"])]),_:1}),e(t(N),{label:"用户等级"},{default:a(()=>[e(t(T),{value:r.value.level,"onUpdate:value":l[2]||(l[2]=i=>r.value.level=i),options:X,placeholder:"选择等级",clearable:"",style:{width:"140px"}},null,8,["value"])]),_:1}),e(t(N),{label:"邮箱绑定"},{default:a(()=>[e(t(T),{value:r.value.hasEmail,"onUpdate:value":l[3]||(l[3]=i=>r.value.hasEmail=i),options:V,placeholder:"邮箱状态",clearable:"",style:{width:"120px"}},null,8,["value"])]),_:1}),e(t(N),{label:"手机绑定"},{default:a(()=>[e(t(T),{value:r.value.hasPhone,"onUpdate:value":l[4]||(l[4]=i=>r.value.hasPhone=i),options:V,placeholder:"手机状态",clearable:"",style:{width:"120px"}},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1}),e(t(_),{bordered:!1,class:"shadow-sm"},{header:a(()=>[s("div",Te,[e(t(d),{size:"18",color:"#409eff"},{default:a(()=>[e(t(L))]),_:1}),l[12]||(l[12]=s("span",{class:"font-medium"},"用户列表",-1))])]),"header-extra":a(()=>[e(t(J),{align:"center"},{default:a(()=>[e(t(m),{depth:"3"},{default:a(()=>[u(" 显示 "+f(S.value.length)+" / "+f(x.value.length)+" 条记录 ",1)]),_:1}),e(t(P),{size:"small",onClick:le,loading:p.value},{icon:a(()=>[e(t(d),null,{default:a(()=>[e(t(F))]),_:1})]),default:a(()=>[l[13]||(l[13]=u(" 刷新 "))]),_:1,__:[13]},8,["loading"])]),_:1})]),default:a(()=>[e(t(pe),{columns:te,data:S.value,loading:p.value,pagination:{pageSize:10,showSizePicker:!0,pageSizes:[10,20,50]},"flex-height":"",class:"min-h-400px","row-class-name":()=>"hover:bg-blue-50 transition-colors duration-200"},null,8,["data","loading"])]),_:1}),e(t(ce),{show:z.value,"onUpdate:show":l[5]||(l[5]=i=>z.value=i),preset:"card",style:{width:"900px","max-height":"80vh"},class:"rounded-2xl","mask-closable":!1},{header:a(()=>[s("div",Pe,[e(t(G),{size:40,style:fe({backgroundColor:o.value.gender===1?"#409eff":o.value.gender===2?"#f56c6c":"#909399"})},{default:a(()=>[e(t(d),{size:"20"},{default:a(()=>[e(t(M))]),_:1})]),_:1},8,["style"]),s("div",null,[s("h3",je,f(o.value.nickname||o.value.nickName||"用户详情"),1),s("p",Ee," ID: "+f(o.value.userId||"-"),1)])])]),default:a(()=>[E.value?(k(),C("div",ll,[e(t(ye),{size:"large"},{description:a(()=>l[28]||(l[28]=[s("div",{class:"text-center mt-4"},[s("p",{class:"text-gray-600"},"正在加载用户详情..."),s("p",{class:"text-sm text-gray-400 mt-1"},"请稍候片刻")],-1)])),_:1})])):(k(),C("div",Oe,[s("div",Se,[e(t(B),{cols:4,"x-gap":20},{default:a(()=>[e(t(h),null,{default:a(()=>[s("div",Ie,[s("div",De,f(o.value.stats?.totalOrders||0),1),l[14]||(l[14]=s("div",{class:"text-sm text-gray-600"},"总订单数",-1))])]),_:1}),e(t(h),null,{default:a(()=>[s("div",Me,[s("div",Be,f(o.value.stats?.favoriteCount||0),1),l[15]||(l[15]=s("div",{class:"text-sm text-gray-600"},"收藏商品",-1))])]),_:1}),e(t(h),null,{default:a(()=>[s("div",Ue,[s("div",Le,f(o.value.levelText||"-"),1),l[16]||(l[16]=s("div",{class:"text-sm text-gray-600"},"用户等级",-1))])]),_:1}),e(t(h),null,{default:a(()=>[s("div",Ae,[s("div",Ve,f(o.value.createdAt?Math.floor((Date.now()-new Date(o.value.createdAt).getTime())/(1e3*60*60*24)):"-"),1),l[17]||(l[17]=s("div",{class:"text-sm text-gray-600"},"注册天数",-1))])]),_:1})]),_:1})]),e(t(ie)),e(t(B),{cols:2,"x-gap":24,"y-gap":20},{default:a(()=>[e(t(h),null,{default:a(()=>[e(t(_),{title:"基本信息",size:"small",class:"h-full"},{"header-extra":a(()=>[e(t(d),{color:"#409eff"},{default:a(()=>[e(t(M))]),_:1})]),default:a(()=>[s("div",$e,[s("div",Re,[l[18]||(l[18]=s("span",{class:"text-gray-600 font-medium"},"用户ID",-1)),e(t(m),{code:"",style:{"word-break":"break-all","max-width":"200px"}},{default:a(()=>[u(f(o.value.userId||"-"),1)]),_:1})]),s("div",Fe,[l[19]||(l[19]=s("span",{class:"text-gray-600 font-medium"},"用户昵称",-1)),e(t(m),{strong:""},{default:a(()=>[u(f(o.value.nickName||o.value.nickname||"未设置"),1)]),_:1})]),s("div",Ge,[l[20]||(l[20]=s("span",{class:"text-gray-600 font-medium"},"性别",-1)),e(t(b),{type:o.value.gender===1?"info":o.value.gender===2?"error":"default",size:"small"},{default:a(()=>[u(f(o.value.genderText||"未知"),1)]),_:1},8,["type"])]),s("div",He,[l[21]||(l[21]=s("span",{class:"text-gray-600 font-medium"},"用户等级",-1)),e(t(b),{type:"warning",size:"small"},{icon:a(()=>[o.value.level>=2?(k(),ue(t(d),{key:0},{default:a(()=>[e(t(j))]),_:1})):de("",!0)]),default:a(()=>[u(" "+f(o.value.levelText||"普通用户"),1)]),_:1})]),s("div",Je,[l[22]||(l[22]=s("span",{class:"text-gray-600 font-medium"},"生日",-1)),e(t(m),null,{default:a(()=>[u(f(o.value.birthday||"未设置"),1)]),_:1})])])]),_:1})]),_:1}),e(t(h),null,{default:a(()=>[e(t(_),{title:"联系信息",size:"small",class:"h-full"},{"header-extra":a(()=>[e(t(d),{color:"#67c23a"},{default:a(()=>[e(t(U))]),_:1})]),default:a(()=>[s("div",Ke,[s("div",We,[s("span",Ye,[e(t(d),{size:"16",color:"#409eff"},{default:a(()=>[e(t(U))]),_:1}),l[23]||(l[23]=u(" 邮箱地址 "))]),e(t(m),null,{default:a(()=>[u(f(o.value.email||"未绑定"),1)]),_:1})]),s("div",qe,[s("span",Qe,[e(t(d),{size:"16",color:"#67c23a"},{default:a(()=>[e(t(H))]),_:1}),l[24]||(l[24]=u(" 手机号码 "))]),e(t(m),null,{default:a(()=>[u(f(o.value.phoneNumber||"未绑定"),1)]),_:1})]),s("div",Xe,[l[25]||(l[25]=s("span",{class:"text-gray-600 font-medium"},"邮箱验证",-1)),e(t(b),{type:o.value.email?"success":"default",size:"small"},{default:a(()=>[u(f(o.value.hasEmail),1)]),_:1},8,["type"])]),s("div",Ze,[l[26]||(l[26]=s("span",{class:"text-gray-600 font-medium"},"手机验证",-1)),e(t(b),{type:o.value.phoneNumber?"success":"default",size:"small"},{default:a(()=>[u(f(o.value.hasPhone),1)]),_:1},8,["type"])]),s("div",el,[l[27]||(l[27]=s("span",{class:"text-gray-600 font-medium"},"注册时间",-1)),e(t(m),{depth:"3"},{default:a(()=>[u(f(o.value.createdAt?new Date(o.value.createdAt).toLocaleString():"未知"),1)]),_:1})])])]),_:1})]),_:1})]),_:1})]))]),_:1},8,["show"])]))}}),vl=me(tl,[["__scopeId","data-v-bc56aba3"]]);export{vl as default};
//# sourceMappingURL=index-BrhDR3E0.js.map
